<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Code documentation of the Simulation part of the HepEmShow application. &mdash; HepEmShow a compact EM shower simulation 0.0.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=525cde36"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Bibliography" href="../zzbib.html" />
    <link rel="prev" title="Code documentation" href="../CodeDoc.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> HepEmShow a compact EM shower simulation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../IntroAndInstall/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../IntroAndInstall/install.html">Build and Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../IntroAndInstall/components.html">The components of the simulation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../CodeDoc.html">Code documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Code documentation of the <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> part of the <code class="docutils literal notranslate"><span class="pre">HepEmShow</span></code> application.</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-main-of-the-hepemshow-application">The main of the <code class="docutils literal notranslate"><span class="pre">HepEmShow</span></code> application</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-geometry-description-related-code-documentation">The <code class="docutils literal notranslate"><span class="pre">Geometry</span></code> description related code documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-physics-code-documentation">The <code class="docutils literal notranslate"><span class="pre">Physics</span></code> code documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-primarygenerator-code-documentation">The <code class="docutils literal notranslate"><span class="pre">PrimaryGenerator</span></code> code documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#auxiliary-code-documentation">Auxiliary code documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#collecting-data-during-the-simulation">Collecting data during the simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#providing-input-arguments-to-the-hepemshow-application">Providing input arguments to the <code class="docutils literal notranslate"><span class="pre">HepEmShow</span></code> application</a></li>
<li class="toctree-l4"><a class="reference internal" href="#event-loop-stepping-loops-and-the-track-stack">Event loop, stepping loops and the track stack</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../zzbib.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">HepEmShow a compact EM shower simulation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../CodeDoc.html">Code documentation</a></li>
      <li class="breadcrumb-item active">Code documentation of the <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> part of the <code class="docutils literal notranslate"><span class="pre">HepEmShow</span></code> application.</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="code-documentation-of-the-simulation-part-of-the-hepemshow-application">
<h1>Code documentation of the <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> part of the <code class="docutils literal notranslate"><span class="pre">HepEmShow</span></code> application.<a class="headerlink" href="#code-documentation-of-the-simulation-part-of-the-hepemshow-application" title="Permalink to this heading"></a></h1>
<section id="the-main-of-the-hepemshow-application">
<h2>The main of the <code class="docutils literal notranslate"><span class="pre">HepEmShow</span></code> application<a class="headerlink" href="#the-main-of-the-hepemshow-application" title="Permalink to this heading"></a></h2>
<p>The main funtion of the <code class="docutils literal notranslate"><span class="pre">HepEmShow</span></code> application. </p>
<p><dl class="simple">
<dt><strong>Author</strong></dt><dd><p>M. Novak </p>
</dd>
<dt><strong>Date</strong></dt><dd><p>July 2023</p>
</dd>
</dl>
</p>
<p>The main of the <code class="docutils literal notranslate"><span class="pre">HepEmShow</span></code> application is responsible for setting up the environment, lunch the simulation and write the results. This is done by:<ul class="simple">
<li><p>reading the input arguments provided at the execution of the application into an <code class="docutils literal notranslate"><a class="reference internal" href="#struct_input_parameters"><span class="std std-ref"><span class="pre">InputParameters</span></span></a></code> object. (Note, these arguments provide configuration options).</p></li>
<li><p>loading the <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> data and parameters from file into a <code class="docutils literal notranslate"><span class="pre">G4HepEmState</span></code> (see the note below)</p></li>
<li><p>constructing a <code class="docutils literal notranslate"><span class="pre">G4HepEmTLData</span></code> (also required by <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> and encapsulates the random number generator and some track buffers) with its random number generator (utilising the local <code class="docutils literal notranslate"><a class="reference internal" href="#class_u_random"><span class="std std-ref"><span class="pre">URandom</span></span></a></code> generator)</p></li>
<li><p>constructing and setting up the application <code class="docutils literal notranslate"><a class="reference internal" href="#class_geometry"><span class="std std-ref"><span class="pre">Geometry</span></span></a></code> according to the provided configuration input arguments (in <code class="docutils literal notranslate"><a class="reference internal" href="#struct_input_parameters"><span class="std std-ref"><span class="pre">InputParameters</span></span></a></code>)</p></li>
<li><p>constructing and setting up a <code class="docutils literal notranslate"><a class="reference internal" href="#struct_results"><span class="std std-ref"><span class="pre">Results</span></span></a></code> structure that will be used to collect some data during the simulation</p></li>
<li><p>constructing and setting up the <code class="docutils literal notranslate"><a class="reference internal" href="#class_primary_generator"><span class="std std-ref"><span class="pre">PrimaryGenerator</span></span></a></code> of the application according to the provided configuration input arguments (in <code class="docutils literal notranslate"><a class="reference internal" href="#struct_input_parameters"><span class="std std-ref"><span class="pre">InputParameters</span></span></a></code>)</p></li>
<li><p>the <code class="docutils literal notranslate"><a class="reference internal" href="#class_event_loop_1a7b1d4b512c5fa676bd990cfaa6d561c9"><span class="std std-ref"><span class="pre">EventLoop::ProcessEvents</span></span></a></code> method is invoked then to <strong>perform the simulation</strong></p></li>
<li><p>the simulation results are witten to file (and to the standard output) by invoking <code class="docutils literal notranslate"><a class="reference internal" href="#_results_8hh_1a2e94780b3b797ba10abaf1154db56016"><span class="std std-ref"><span class="pre">WriteResults()</span></span></a></code> (from the <code class="docutils literal notranslate"><a class="reference internal" href="#struct_results"><span class="std std-ref"><span class="pre">Results</span></span></a></code>)</p></li>
</ul>
</p>
<p><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> data file is either the one included in the <code class="docutils literal notranslate"><span class="pre">HepEmShow</span></code> repository (under <code class="docutils literal notranslate"><span class="pre">hepemshow/data/</span></code>) or generated by the auxiliary <code class="docutils literal notranslate"><span class="pre">HepEmShow-DataGeneration</span></code> application. In the former case, the data file contains all data that <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> needs for the simulation for the 3 default (<code class="docutils literal notranslate"><span class="pre">{&quot;G4_Galactic&quot;,</span> <span class="pre">&quot;G4_PbWO4&quot;,</span> <span class="pre">&quot;G4_lAr&quot;}</span></code>) materials, i.e. those used in the default <code class="docutils literal notranslate"><a class="reference internal" href="#class_geometry"><span class="std std-ref"><span class="pre">Geometry</span></span></a></code> configuration. </p>
</div>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv44mainiA_Pc">
<span class="target" id="_hep_em_show_8cc_1a0ddf1224851353fc92bfbff6f499fa97"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">main</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">argc</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">argv</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv44mainiA_Pc" title="Permalink to this definition"></a><br /></dt>
<dd><p>The main function of the <code class="docutils literal notranslate"><span class="pre">HepEmShow</span></code> simulation application (see more in the description). </p>
</dd></dl>

</div>
</section>
<section id="the-geometry-description-related-code-documentation">
<h2>The <code class="docutils literal notranslate"><span class="pre">Geometry</span></code> description related code documentation<a class="headerlink" href="#the-geometry-description-related-code-documentation" title="Permalink to this heading"></a></h2>
<p>The <a class="reference internal" href="#_CPPv48Geometry" title="Geometry"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Geometry</span></code></a> of this application is built up from 5 <a class="reference internal" href="#_CPPv43Box" title="Box"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Box</span></code></a>
objects (by default, i.e. at non-zero <code class="docutils literal notranslate"><span class="pre">gap</span></code> thickness): an <code class="docutils literal notranslate"><span class="pre">absorber</span></code> and
a <code class="docutils literal notranslate"><span class="pre">gap</span></code> building up a <code class="docutils literal notranslate"><span class="pre">layer</span></code> that is repeated <cite>N</cite> times along the <cite>x</cite>-axis
building up and filling in the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> that is centered at the origin
and placed in the <code class="docutils literal notranslate"><span class="pre">world</span></code>.</p>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv48Geometry">
<span class="target" id="class_geometry"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Geometry</span></span></span><a class="headerlink" href="#_CPPv48Geometry" title="Permalink to this definition"></a><br /></dt>
<dd><p><a class="reference internal" href="#class_geometry"><span class="std std-ref">Geometry</span></a> description for this simple simulation setup. </p>
<p><dl class="simple">
<dt><strong>Author</strong></dt><dd><p>M. Novak </p>
</dd>
<dt><strong>Date</strong></dt><dd><p>July 2023</p>
</dd>
</dl>
</p>
<p>The simulation setup is a <strong>configurable simplified sampling calorimeter</strong> built up from <code class="docutils literal notranslate"><span class="pre">N</span></code> layers of an <code class="docutils literal notranslate"><span class="pre">absorber</span></code> and a <code class="docutils literal notranslate"><span class="pre">gap</span></code> (both by default). The number of layers <code class="docutils literal notranslate"><span class="pre">N</span></code>, the thickness of both the <code class="docutils literal notranslate"><span class="pre">absorber</span></code> and <code class="docutils literal notranslate"><span class="pre">gap</span></code> along the x-axes can be set and changed dynamically.</p>
<p><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">layer</span></code>:<ul>
<li><p>number : <code class="docutils literal notranslate"><span class="pre">fNumLayers</span></code></p></li>
<li><p>set/get : <code class="docutils literal notranslate"><a class="reference internal" href="#class_geometry_1a47d793bed18a5599b656e85b502109ac"><span class="std std-ref"><span class="pre">SetNumLayers(int)</span></span></a></code>/<code class="docutils literal notranslate"><a class="reference internal" href="#class_geometry_1a5b246547a35881d7eb2b6980952f4004"><span class="std std-ref"><span class="pre">GetNumLayers()</span></span></a></code></p></li>
<li><p>thickness: <code class="docutils literal notranslate"><span class="pre">fLayerThick</span></code> (calculated automatically from the <code class="docutils literal notranslate"><span class="pre">absorber</span></code> and <code class="docutils literal notranslate"><span class="pre">gap</span></code> thicknesses)</p></li>
</ul>
</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">absorber</span></code>:<ul>
<li><p>thickness: <code class="docutils literal notranslate"><span class="pre">fAbsThick</span></code></p></li>
<li><p>set/get : <code class="docutils literal notranslate"><a class="reference internal" href="#class_geometry_1a24eaa81106907bbef4404407b4093bbf"><span class="std std-ref"><span class="pre">SetAbsThick(double)</span></span></a></code>/<code class="docutils literal notranslate"><a class="reference internal" href="#class_geometry_1a45b4edf0b8cd260cf3487e5831cdb57e"><span class="std std-ref"><span class="pre">GetAbsThick()</span></span></a></code></p></li>
<li><p>material : lead tungstate/atolzite (<code class="docutils literal notranslate"><span class="pre">&quot;G4_PbWO4&quot;</span></code>) with material <code class="docutils literal notranslate"><span class="pre">index</span> <span class="pre">=</span> <span class="pre">1</span></code> (by default)</p></li>
</ul>
</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gap</span></code>:<ul>
<li><p>thickness: <code class="docutils literal notranslate"><span class="pre">fGapThick</span></code></p></li>
<li><p>set/get : <code class="docutils literal notranslate"><a class="reference internal" href="#class_geometry_1a07629f80bdfada5f95ce3657aa2887b7"><span class="std std-ref"><span class="pre">SetGapThick(double)</span></span></a></code>/<code class="docutils literal notranslate"><a class="reference internal" href="#class_geometry_1af925634f36ca10963e9c58f8b675fbeb"><span class="std std-ref"><span class="pre">GetGapThick()</span></span></a></code></p></li>
<li><p>material : liquid argon (<code class="docutils literal notranslate"><span class="pre">&quot;G4_lAr&quot;</span></code>) with material <code class="docutils literal notranslate"><span class="pre">index</span> <span class="pre">=</span> <span class="pre">2</span></code> (by default)</p></li>
</ul>
</p></li>
</ul>
</p>
<p>
All thickness measured along the <code class="docutils literal notranslate"><span class="pre">x</span></code> axes while the <code class="docutils literal notranslate"><span class="pre">yz</span></code> extent is the same both for the <code class="docutils literal notranslate"><span class="pre">absorber</span></code> and <code class="docutils literal notranslate"><span class="pre">gap</span></code> determined by the <code class="docutils literal notranslate"><span class="pre">fCaloSizeYZ</span></code> which can be set dynamically by <code class="docutils literal notranslate"><span class="pre">SetCaloSizeYZ(val)/GetCaloSizeYZ()</span></code>.<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The default length unit is [mm] so all thicknesses and sizes are assumed to be give in [mm] units.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">gap</span></code> thickness can be set even to zero in which case the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> is built up from the given number of <code class="docutils literal notranslate"><span class="pre">layer</span></code>s of <code class="docutils literal notranslate"><span class="pre">absorber</span></code> with the given thickness (i.e. a single material calorimeter sliced by the <code class="docutils literal notranslate"><span class="pre">layer</span></code>s).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The material indices are determined by the order of the corresponding <code class="docutils literal notranslate"><span class="pre">Geant4</span></code> (predefined NIST) material names listed in the material name vector of the data extraction application (i.e. in <code class="docutils literal notranslate"><span class="pre">DataGeneration.cc</span></code>). This application is used beforehand to extract the material (and cuts) dependent data required during the simulation. The default vector in <code class="docutils literal notranslate"><span class="pre">DataGeneration.cc</span></code>, that was used to extract the provided data files, is <div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">Geant4</span> <span class="p">(</span><span class="n">NIST</span><span class="p">)</span> <span class="n">material</span> <span class="n">names</span>
<span class="n">std</span><span class="p">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="p">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">matList</span> <span class="p">{</span><span class="s2">&quot;G4_Galactic&quot;</span><span class="p">,</span> <span class="s2">&quot;G4_PbWO4&quot;</span><span class="p">,</span> <span class="s2">&quot;G4_lAr&quot;</span><span class="p">};</span>
</pre></div>
</div>
 hence the above <code class="docutils literal notranslate"><span class="pre">material</span> <span class="pre">-</span> <span class="pre">index</span></code> mapping. Changing the material name(s) in this above vector (especially at index <code class="docutils literal notranslate"><span class="pre">1</span></code> and/or <code class="docutils literal notranslate"><span class="pre">2</span></code> as the vacuum is always needed to fill the container volumes like the <code class="docutils literal notranslate"><span class="pre">layer</span></code>, <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> or the <code class="docutils literal notranslate"><span class="pre">world</span></code> volumes), regenerating the data, then executing the same <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> application, corresponds to changing the mateiral (with the given index) in the simulation. A <a class="reference external" href="https://geant4-userdoc.web.cern.ch/UsersGuides/ForApplicationDeveloper/html/Appendix/materialNames.html">list of the available predefined Geant4 NIST material names</a> can be found in the corresponding part of the Geant4 Documentation.</p>
</div>
</p>
<p>A single layer is composed from the above <code class="docutils literal notranslate"><span class="pre">absorber</span></code> and <code class="docutils literal notranslate"><span class="pre">gap</span></code> while the entire <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> is built up form the given number of identical <code class="docutils literal notranslate"><span class="pre">layer</span></code>s shifted along the <code class="docutils literal notranslate"><span class="pre">x</span></code> axes. The <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> center, i.e. the [0,0,0] position of the corresponding <a class="reference internal" href="#class_box"><span class="std std-ref">Box</span></a> shape local coordinate, is at the global origin (i.e. no translation nor rotation is applied). The entire calorimeter is placed inside the <code class="docutils literal notranslate"><span class="pre">world</span></code> that is the limit of our simulation universe. The <code class="docutils literal notranslate"><span class="pre">layer</span></code>, <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> and <code class="docutils literal notranslate"><span class="pre">world</span></code> is filled with vacuum (very low density hydrogen), so only the <code class="docutils literal notranslate"><span class="pre">absorber</span></code> and the <code class="docutils literal notranslate"><span class="pre">gap</span></code> have non-vacuum like materials.</p>
<p>The shape of all objects (<code class="docutils literal notranslate"><span class="pre">absorber</span></code>, <code class="docutils literal notranslate"><span class="pre">gap</span></code>, <code class="docutils literal notranslate"><span class="pre">layer</span></code>, <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code>, <code class="docutils literal notranslate"><span class="pre">world</span></code>) is <code class="docutils literal notranslate"><a class="reference internal" href="#class_box"><span class="std std-ref"><span class="pre">Box</span></span></a></code>. A box object is constructed for each in the constructor by setting the appropriate name and material index fields. Their proper sizes are calculated and updated automatically whenever one of the above setters, affecting any of the thicknesses or sizes, is invoked.</p>
<p>The geometry can also provide an apropriate initial <code class="docutils literal notranslate"><span class="pre">x</span></code> position for the primary particles locating in between the <code class="docutils literal notranslate"><span class="pre">world</span></code> and the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> on the left hand side (<code class="docutils literal notranslate"><a class="reference internal" href="#class_geometry_1a69f072bb3a6ecda07dd7f8c907fc03c9"><span class="std std-ref"><span class="pre">GetPrimaryXposition()</span></span></a></code>). The <code class="docutils literal notranslate"><span class="pre">x</span></code> position, where the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> starts on the left hand side, can also be obtained (<code class="docutils literal notranslate"><a class="reference internal" href="#class_geometry_1a783dfbcefde35a75bee9d08d33fb3908"><span class="std std-ref"><span class="pre">GetCaloStartXposition()</span></span></a></code>). These method will always give an appropriate value as the corresponding data are also updated dynamically whenever any of the thicknesses or sizes are modified.</p>
<p>The geometry also provides a very simple “navigation” through its <code class="docutils literal notranslate"><a class="reference internal" href="#class_geometry_1af34c4d9e94d5026ed64104c3accbb354"><span class="std std-ref"><span class="pre">CalculateDistanceToOut(double*,</span> <span class="pre">double*,</span> <span class="pre">Box**,</span> <span class="pre">int*,</span> <span class="pre">int*)</span></span></a></code> method that determines:<ul class="simple">
<li><p>the (deepest) volume/box in which the given global <code class="docutils literal notranslate"><span class="pre">position</span></code> is located</p></li>
<li><p>the index of the layer (only if the point is located inside the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code>)</p></li>
<li><p>and the index of the absorber: 0 for the <code class="docutils literal notranslate"><span class="pre">absorber</span></code> and 1 for the <code class="docutils literal notranslate"><span class="pre">gap</span></code> (but only in case the point is inside the calorimeter)</p></li>
</ul>
</p>
<p>At the end, it returns:<ul class="simple">
<li><p>a large (1E+20 [mm]) value whenever the <code class="docutils literal notranslate"><span class="pre">position</span></code> and <code class="docutils literal notranslate"><span class="pre">direction</span></code> is such that the particle is about leaving the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> (i.e. going to vacuum then would hit the boundary of the <code class="docutils literal notranslate"><span class="pre">world</span></code> at the end of that step)</p></li>
<li><p>otherwise: the distance to the boundary of the volume in which the given <code class="docutils literal notranslate"><span class="pre">position</span></code> was located: from the given <code class="docutils literal notranslate"><span class="pre">position</span></code> along the given <code class="docutils literal notranslate"><span class="pre">direction</span></code>.</p></li>
</ul>
</p>
<p>Note, that this distance is computed by using the corresponding box/volume method (namely <code class="docutils literal notranslate"><a class="reference internal" href="#class_box_1aad17ace7ec8e5b684b09833a3d35a2bc"><span class="std std-ref"><span class="pre">Box::DistanceToOut(double*,double*)</span> <span class="pre">const</span></span></a></code>) and the <code class="docutils literal notranslate"><span class="pre">box</span></code> object in which the given <code class="docutils literal notranslate"><span class="pre">position</span></code> was located:<ul class="simple">
<li><p>distance to out is 0 if a given <code class="docutils literal notranslate"><span class="pre">position</span></code> is outside of that volume/box</p></li>
<li><p>volume boundaries, closer to <code class="docutils literal notranslate"><span class="pre">position</span></code> than half of the <code class="docutils literal notranslate"><a class="reference internal" href="#class_box_1a92e002367dac759cdb49991eccb80869"><span class="std std-ref"><span class="pre">Box::kCarTolerance</span></span></a></code> (= 1E-9 [mm]), are ignored when the direction is pointing out, i.e. these positions are considered to be outside, leading to 0 distance to the volume boundary from inside. (see more on <code class="docutils literal notranslate"><span class="pre">inside</span></code>, <code class="docutils literal notranslate"><span class="pre">surface</span></code> and <code class="docutils literal notranslate"><span class="pre">outside</span></code> at the <code class="docutils literal notranslate"><a class="reference internal" href="#class_box"><span class="std std-ref"><span class="pre">Box</span></span></a></code> documentation)</p></li>
</ul>
</p>
<p>A small (e.g. 1E-6 [mm]) push along the current direction might be applied in the steppers when the distance to out was found to be 0.</p>
<p>This is because it’s assumed, that the 0 distance is due to the employed simple location calculation, that ignors the tolerance, instead of using an apropriate navigator. Namely, the point was located in volume A. but it’s actually on its <code class="docutils literal notranslate"><span class="pre">surface</span></code>: closer than <code class="docutils literal notranslate"><a class="reference internal" href="#class_box_1a92e002367dac759cdb49991eccb80869"><span class="std std-ref"><span class="pre">Box::kCarTolerance</span></span></a></code>/2 to its boundary. Morover, the direction is pointing toward to the next, volume B., that is just on the other side of this boundary. This correctly gives 0 distance to the boundary of volume A as actually the given step will be done in volume B. Therefore, the small push is to overcome the volume boundary, i.e. to push the point to be on the other side of the boundary between volume A and B. Then, the point is calulated to be in volume B now when relocating and as the direction is pointing inside volume B, the expected distance to the next boundary of volume B is computed. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Geometry8GeometryEv">
<span class="target" id="class_geometry_1a4c301c163c63d21ed08c17b0f4e131d3"></span><span class="sig-name descname"><span class="n"><span class="pre">Geometry</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Geometry8GeometryEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Constructor: sets the default configuration, creates the <a class="reference internal" href="#class_box"><span class="std std-ref">Box</span></a> objects for all components. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8GeometryD0Ev">
<span class="target" id="class_geometry_1ad55e832122ab3a2833dcaa6507867678"></span><span class="sig-name descname"><span class="n"><span class="pre">~Geometry</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8GeometryD0Ev" title="Permalink to this definition"></a><br /></dt>
<dd><p>Destructor: deletes the <a class="reference internal" href="#class_box"><span class="std std-ref">Box</span></a> objects that represents the volume of the components. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Geometry12SetNumLayersEi">
<span class="target" id="class_geometry_1a47d793bed18a5599b656e85b502109ac"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SetNumLayers</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nlayers</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Geometry12SetNumLayersEi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Sets the number of layers the entire calorimeter should be built up. </p>
<p><dl class="field-list simple">
<dt class="field-odd">param nlayers<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[in]</strong> Number of layers (must be &gt; 0) requested (all parameters are recalculated). </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK8Geometry12GetNumLayersEv">
<span class="target" id="class_geometry_1a5b246547a35881d7eb2b6980952f4004"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GetNumLayers</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK8Geometry12GetNumLayersEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Gives the number of layers the calorimeter is built up. </p>
<p><dl class="field-list simple">
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>number of layers. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK8Geometry12GetCaloThickEv">
<span class="target" id="class_geometry_1a957b5b3bb7f9a971b691f0741d7ca172"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GetCaloThick</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK8Geometry12GetCaloThickEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Gives the thickness of the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> (i.e. </p>
<p>full size along the x-axis). <dl class="field-list simple">
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>thickness of the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> in [mm] units. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Geometry11SetAbsThickEd">
<span class="target" id="class_geometry_1a24eaa81106907bbef4404407b4093bbf"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SetAbsThick</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">thickness</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Geometry11SetAbsThickEd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Sets the required absorber thickness (i.e. </p>
<p>full size along the x-axis). <dl class="field-list simple">
<dt class="field-odd">param thickness<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[in]</strong> Required thickness of the <code class="docutils literal notranslate"><span class="pre">absorber</span></code> in [mm]. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK8Geometry11GetAbsThickEv">
<span class="target" id="class_geometry_1a45b4edf0b8cd260cf3487e5831cdb57e"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GetAbsThick</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK8Geometry11GetAbsThickEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Gives the thickness of the <code class="docutils literal notranslate"><span class="pre">absorber</span></code> (i.e. </p>
<p>full size along the x-axis). <dl class="field-list simple">
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>thickness of the <code class="docutils literal notranslate"><span class="pre">absorber</span></code> in [mm] units. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Geometry11SetGapThickEd">
<span class="target" id="class_geometry_1a07629f80bdfada5f95ce3657aa2887b7"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SetGapThick</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">thickness</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Geometry11SetGapThickEd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Sets the required <code class="docutils literal notranslate"><span class="pre">gap</span></code> thickness (i.e. </p>
<p>full size along the x-axis).</p>
<p>Note, that the <code class="docutils literal notranslate"><span class="pre">gap</span></code> thickness can also be set to zero. The calorimeter is built up from a single material layers, i.e. a block of material sliced along the x-axis.</p>
<p><dl class="field-list simple">
<dt class="field-odd">param thickness<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[in]</strong> Required thickness of the <code class="docutils literal notranslate"><span class="pre">gap</span></code> in [mm] (can be set to 0). </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK8Geometry11GetGapThickEv">
<span class="target" id="class_geometry_1af925634f36ca10963e9c58f8b675fbeb"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GetGapThick</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK8Geometry11GetGapThickEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Gives the thickness of the <code class="docutils literal notranslate"><span class="pre">gap</span></code> (i.e. </p>
<p>full size along the x-axis). <dl class="field-list simple">
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>thickness of the <code class="docutils literal notranslate"><span class="pre">gap</span></code> in [mm] units. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Geometry13SetCaloSizeYZEd">
<span class="target" id="class_geometry_1a788be363c5ccfd2ccc25e68c404fec3b"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SetCaloSizeYZ</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">val</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Geometry13SetCaloSizeYZEd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Sets the transverse size (i.e. </p>
<p>full size along the yz-axes).</p>
<p>Note, this also determines <code class="docutils literal notranslate"><span class="pre">yz</span></code> sizes of the corresponding the <code class="docutils literal notranslate"><span class="pre">absorber</span></code>, <code class="docutils literal notranslate"><span class="pre">gap</span></code> and <code class="docutils literal notranslate"><span class="pre">layer</span></code> volumes/shapes.</p>
<p><dl class="field-list simple">
<dt class="field-odd">param val<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[in]</strong> Required full transvers size of the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> in [mm]. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK8Geometry13GetCaloSizeYZEv">
<span class="target" id="class_geometry_1a60cf831680c87637e3efdbab06559688"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GetCaloSizeYZ</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK8Geometry13GetCaloSizeYZEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Gives the transverse size of the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> (i.e. </p>
<p>full size along the yz-axis). <dl class="field-list simple">
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>full transverse size of the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> volume/shape in [mm] units. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK8Geometry19GetPrimaryXpositionEv">
<span class="target" id="class_geometry_1a69f072bb3a6ecda07dd7f8c907fc03c9"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GetPrimaryXposition</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK8Geometry19GetPrimaryXpositionEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Provides the x-coordinate of the mid-position between the <code class="docutils literal notranslate"><span class="pre">world</span></code> and <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> boundaries on the left hand side. </p>
<p>Note that this is only for the primary generator, the primary tracks should be inside the calorimeter or its boundary but pointing inside (see more at <code class="docutils literal notranslate"><a class="reference internal" href="#class_geometry_1af34c4d9e94d5026ed64104c3accbb354"><span class="std std-ref"><span class="pre">CalculateDistanceToOut()</span></span></a></code>)</p>
<p><dl class="field-list simple">
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>the x-coordinate of the mid-point between the <code class="docutils literal notranslate"><span class="pre">world</span></code> and <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> boundaries on the left. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK8Geometry21GetCaloStartXpositionEv">
<span class="target" id="class_geometry_1a783dfbcefde35a75bee9d08d33fb3908"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GetCaloStartXposition</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK8Geometry21GetCaloStartXpositionEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Provides the x-coordinate on the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> boundary on the left hand side. </p>
<p>Note this is the initial x-coordinate of each primary track while their direction should point toward the calorimeter (i.e. having positive x-coordiante).</p>
<p><dl class="field-list simple">
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>the x-coordinate of the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> boundary on the left hand side. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Geometry22CalculateDistanceToOutEPdPdPP3BoxPiPi">
<span class="target" id="class_geometry_1af34c4d9e94d5026ed64104c3accbb354"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CalculateDistanceToOut</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">v</span></span>, <a class="reference internal" href="#_CPPv43Box" title="Box"><span class="n"><span class="pre">Box</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">currentVolume</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">indxLayer</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">indxAbs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Geometry22CalculateDistanceToOutEPdPdPP3BoxPiPi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Locates a point in the geometry and calculates the distance till the next boundary. </p>
<p>This method is supposed to be called at the pre-step point of the simulation step with the global pre-step ponit coordinates and actual direction in order to:<ul class="simple">
<li><p>determine the volume in which this simulation step will be done (and more importantly, the material as everything depends on that (at least))</p></li>
<li><p>the distance to the boundary of that volume along the given diretion (as the material might change on the other side of that boundary)</p></li>
</ul>
</p>
<p>The pre-step point is supposed to be inside the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> volume, i.e. either<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">inside</span></code>: deeper than <code class="docutils literal notranslate"><a class="reference internal" href="#class_box_1a92e002367dac759cdb49991eccb80869"><span class="std std-ref"><span class="pre">Box::kCarTolerance</span></span></a></code>/2 form any of its boundaries</p></li>
<li><p>on <code class="docutils literal notranslate"><span class="pre">surface</span></code>: closer to a boundary than <code class="docutils literal notranslate"><a class="reference internal" href="#class_box_1a92e002367dac759cdb49991eccb80869"><span class="std std-ref"><span class="pre">Box::kCarTolerance</span></span></a></code>/2 While the distance to the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> volume boundary is &gt; zero in the first case, this depends on the actual direction in the second case:</p></li>
<li><p>zero: when the direction is pointing outside of that boundary, i.e. particle is about leaving the volume</p></li>
<li><p>positive: as the particle is about moving in the volume otherwise These are true for all (and not only for the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code>) volumes!</p></li>
</ul>
</p>
<p>During the simulation, each primary track starts from the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> volume boundary with a direction that is pointing inside, i.e. ensured to be inside (on <code class="docutils literal notranslate"><span class="pre">surface</span></code> but pointing in). All tracks are terminated when the particle is about leaving the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code>, i.e. the particle is on <code class="docutils literal notranslate"><span class="pre">surface</span></code> and pointing out (as the step would be done in the vaccum ending on the boundary of our <code class="docutils literal notranslate"><span class="pre">world</span></code>). Therefore, all step pints, and secondary tracks created at some of these points, are also ensured to be inside the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> (as defined above).</p>
<p>In order to achive the above, this method returns with a large (1E+20 [mm]) distance to boundary whenever the particle is about leaving the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code>. The point (the step) is located to be in the <code class="docutils literal notranslate"><span class="pre">world</span></code> volume (<code class="docutils literal notranslate"><span class="pre">layer</span></code> and <code class="docutils literal notranslate"><span class="pre">absorber</span></code> indices are set to -1). Otherwise, the point is located, i.e. the deepest volume inside the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> in which the point is located, is determined, the <code class="docutils literal notranslate"><span class="pre">layer</span></code> and <code class="docutils literal notranslate"><span class="pre">absorber</span></code> indices are set.</p>
<p>However, this is done based on a simply computation of the <code class="docutils literal notranslate"><span class="pre">layer</span></code> index (based on its thickness) then the same within the layer. In other words, this is done without considering the tolerance or the direction (unlike in Geant4, having a robust but complex navigator for this). Therefore, it might be the case that the point is calculated to be inside a given volume but actually it’s on the <code class="docutils literal notranslate"><span class="pre">surface</span></code> while moving out. The corresponding simulation step should actually be performed in the next volume (that is just on the other side of that boundary). This is detected during the simulation step computation, as this method returns zero distance in this case, and:<ul class="simple">
<li><p>a small push of 1E-6 [mm] is applied along the current direction (just to push the point to the other side of the boundary)</p></li>
<li><p>this method is called again with the new position: calculated to be in the good volume now</p></li>
</ul>
</p>
<p>The input position, given in global coordinates, always transformed to the local system of the given volume. This is an identity transformation for the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> (as not translated nor rotated). Then for the <code class="docutils literal notranslate"><span class="pre">layer</span></code>, the translation vector (having non-zero only its x-component) is determined based on the first layer x-position (where the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> starts), the thickness of the <code class="docutils literal notranslate"><span class="pre">layer</span></code> and the current x-position of the point. After transforming the point to <code class="docutils literal notranslate"><span class="pre">layer</span></code> local coordinates, the position is transformed further either to <code class="docutils literal notranslate"><span class="pre">absorber</span></code> or <code class="docutils literal notranslate"><span class="pre">gap</span></code> local coorinates depending on which the point was calculated to be in. At the end, the input position vector contains the position of the point in the local system of the volume/shape that the pint was calculated to be located. Therefore, this local coorinates can be used later directly in any shape (<a class="reference internal" href="#class_box"><span class="std std-ref">Box</span></a>) methods, e.g. for computing the safety.</p>
<p><dl class="field-list simple">
<dt class="field-odd">param r<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[inout]</strong> pointer to a 3D array that stores the x, y and z coorinates of the position in global coordiantes at input. These will be updated to be local coordinates in the system of the volume (<a class="reference internal" href="#class_box"><span class="std std-ref">Box</span></a>) in which the point was located in. </p>
</dd>
<dt class="field-even">param v<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>[in]</strong> pointer to a 3D array that stores the x, y and z coorinates of the current normalised direction vector </p>
</dd>
<dt class="field-odd">param currentVolume<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[inout]</strong> address of a pointer to a <a class="reference internal" href="#class_box"><span class="std std-ref">Box</span></a> object that can be anything at input, while at output the corresponding pointer is set to the <code class="docutils literal notranslate"><a class="reference internal" href="#class_box"><span class="std std-ref"><span class="pre">Box</span></span></a></code> object that represents the volume in which the given point was calculated to be located </p>
</dd>
<dt class="field-even">param indxLayer<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>[inout]</strong> pointer to an integer that can be anything at input, while at output it will be the indx of tha <code class="docutils literal notranslate"><span class="pre">layer</span></code> in which the given point was calculated to be located (-1 when the particle is leaving the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> or no layers) </p>
</dd>
<dt class="field-odd">param indxAbs<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[inout]</strong> pointer to an integer that can be anything at input, while at output it will be 0 or 1 that corresponds to the <code class="docutils literal notranslate"><span class="pre">absorber</span></code> and <code class="docutils literal notranslate"><span class="pre">gap</span></code> depending on which the given point was calculated to be located (-1 when the particle is leaving the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> or no layers) </p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>the distance, from the given position along the given direction, to the boundary of the volume in which the given point was calculated to be located. It might be zero (the step actually shouldn’t be done in the located volume) or 1E+20 [mm] (the particle about leaving the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code>). </p>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-private-functions">Private Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Geometry16UpdateParametersEv">
<span class="target" id="class_geometry_1a3b86bcc854f3a33e73fa52b5ac880a15"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">UpdateParameters</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Geometry16UpdateParametersEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Privite method that clculates the apropriate positions and volume/shape sizes whever any related parameters is updated. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-private-members">Private Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8Geometry10fNumLayersE">
<span class="target" id="class_geometry_1a5780a2301d1cc122f19d49743a96a411"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fNumLayers</span></span></span><a class="headerlink" href="#_CPPv4N8Geometry10fNumLayersE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Number of layers the calorimeter is built up. </p>
<p>Can be set (even to zero: calorimeter is just a single volume/box) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8Geometry9fAbsThickE">
<span class="target" id="class_geometry_1a7939a17bb7abf32957f902e4143349ff"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fAbsThick</span></span></span><a class="headerlink" href="#_CPPv4N8Geometry9fAbsThickE" title="Permalink to this definition"></a><br /></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">Absorber</span></code> thickness measured along the <code class="docutils literal notranslate"><span class="pre">x</span></code>-axis in [mm] (can be set) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8Geometry9fGapThickE">
<span class="target" id="class_geometry_1afcaed22992d54b01abfba01dd09fa2d9"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fGapThick</span></span></span><a class="headerlink" href="#_CPPv4N8Geometry9fGapThickE" title="Permalink to this definition"></a><br /></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">Gap</span></code> thickness measured along the <code class="docutils literal notranslate"><span class="pre">x</span></code>-axis in [mm] (can be set; even to zero: single material <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> sliced by layers along the <code class="docutils literal notranslate"><span class="pre">x</span></code>-axis) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8Geometry11fLayerThickE">
<span class="target" id="class_geometry_1a442075c15e051aefeba6648f89207688"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fLayerThick</span></span></span><a class="headerlink" href="#_CPPv4N8Geometry11fLayerThickE" title="Permalink to this definition"></a><br /></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">Layer</span></code> thickness measured along the <code class="docutils literal notranslate"><span class="pre">x</span></code> axes in [mm]. </p>
<p>Computed automatically (whenever the <code class="docutils literal notranslate"><span class="pre">absorber</span></code> or <code class="docutils literal notranslate"><span class="pre">gap</span></code> thickness is updated </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8Geometry10fCaloThickE">
<span class="target" id="class_geometry_1af96f94a6b86482ffa34e8a48ddfb416f"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fCaloThick</span></span></span><a class="headerlink" href="#_CPPv4N8Geometry10fCaloThickE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The thickness of the entire <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> measured along the <code class="docutils literal notranslate"><span class="pre">x</span></code> axes in [mm] Computed automatically whenever the <code class="docutils literal notranslate"><span class="pre">layer</span></code> thickness (i.e. </p>
<p>absorber and/or gap thickness) or number of layer is updated. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8Geometry11fCaloSizeYZE">
<span class="target" id="class_geometry_1a3a114ec53aed78cd5e04d08b4daa3127"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fCaloSizeYZ</span></span></span><a class="headerlink" href="#_CPPv4N8Geometry11fCaloSizeYZE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The transverse size (i.e. </p>
<p>full size along the <code class="docutils literal notranslate"><span class="pre">yz</span></code> axes) of the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> in [mm] units (same for <code class="docutils literal notranslate"><span class="pre">asborber</span></code>, <code class="docutils literal notranslate"><span class="pre">gap</span></code> and <code class="docutils literal notranslate"><span class="pre">layer</span></code> volumes/shapes) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8Geometry11fCaloStartXE">
<span class="target" id="class_geometry_1aea951dfb90df1521866737945ed706cf"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fCaloStartX</span></span></span><a class="headerlink" href="#_CPPv4N8Geometry11fCaloStartXE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The <code class="docutils literal notranslate"><span class="pre">x</span></code>-coordinate of the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> boundary on the left hand size. </p>
<p>Calculated automatically (whenever the related parameters are updated) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8Geometry17fPrimaryXPositionE">
<span class="target" id="class_geometry_1a801f4fb769893443a3801e6b87da8fa6"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fPrimaryXPosition</span></span></span><a class="headerlink" href="#_CPPv4N8Geometry17fPrimaryXPositionE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The <code class="docutils literal notranslate"><span class="pre">x</span></code>-coordinate of the mid-point between the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> and <code class="docutils literal notranslate"><span class="pre">world</span></code> boundaries on the left hand size. </p>
<p>Calculated automatically (whenever the related parameters are updated) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8Geometry9fBoxWorldE">
<span class="target" id="class_geometry_1a79a7642cf113cceb8ebff39f17a559c1"></span><a class="reference internal" href="#_CPPv43Box" title="Box"><span class="n"><span class="pre">Box</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">fBoxWorld</span></span></span><a class="headerlink" href="#_CPPv4N8Geometry9fBoxWorldE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Pointer to the <code class="docutils literal notranslate"><a class="reference internal" href="#class_box"><span class="std std-ref"><span class="pre">Box</span></span></a></code> shape representing the <code class="docutils literal notranslate"><span class="pre">world</span></code> volume. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8Geometry8fBoxCaloE">
<span class="target" id="class_geometry_1ae1927e8a7db773595b8bd9038ab06c72"></span><a class="reference internal" href="#_CPPv43Box" title="Box"><span class="n"><span class="pre">Box</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">fBoxCalo</span></span></span><a class="headerlink" href="#_CPPv4N8Geometry8fBoxCaloE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Pointer to the <code class="docutils literal notranslate"><a class="reference internal" href="#class_box"><span class="std std-ref"><span class="pre">Box</span></span></a></code> shape representing the <code class="docutils literal notranslate"><span class="pre">calorimeter</span></code> volume. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8Geometry9fBoxLayerE">
<span class="target" id="class_geometry_1af7ef69ba1fde966b851634fc3ab132bc"></span><a class="reference internal" href="#_CPPv43Box" title="Box"><span class="n"><span class="pre">Box</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">fBoxLayer</span></span></span><a class="headerlink" href="#_CPPv4N8Geometry9fBoxLayerE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Pointer to the <code class="docutils literal notranslate"><a class="reference internal" href="#class_box"><span class="std std-ref"><span class="pre">Box</span></span></a></code> shape representing the <code class="docutils literal notranslate"><span class="pre">layer</span></code> volume. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8Geometry7fBoxAbsE">
<span class="target" id="class_geometry_1aa094c984f2bc46d4edd4f68fa665826c"></span><a class="reference internal" href="#_CPPv43Box" title="Box"><span class="n"><span class="pre">Box</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">fBoxAbs</span></span></span><a class="headerlink" href="#_CPPv4N8Geometry7fBoxAbsE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Pointer to the <code class="docutils literal notranslate"><a class="reference internal" href="#class_box"><span class="std std-ref"><span class="pre">Box</span></span></a></code> shape representing the <code class="docutils literal notranslate"><span class="pre">absorber</span></code> volume. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8Geometry7fBoxGapE">
<span class="target" id="class_geometry_1a62b4059f63d26b91d8503707c7b2d860"></span><a class="reference internal" href="#_CPPv43Box" title="Box"><span class="n"><span class="pre">Box</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">fBoxGap</span></span></span><a class="headerlink" href="#_CPPv4N8Geometry7fBoxGapE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Pointer to the <code class="docutils literal notranslate"><a class="reference internal" href="#class_box"><span class="std std-ref"><span class="pre">Box</span></span></a></code> shape representing the <code class="docutils literal notranslate"><span class="pre">gap</span></code> volume. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv43Box">
<span class="target" id="class_box"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Box</span></span></span><a class="headerlink" href="#_CPPv43Box" title="Permalink to this definition"></a><br /></dt>
<dd><p>A simplified version of the G4Box shape. </p>
<p><dl class="simple">
<dt><strong>Author</strong></dt><dd><p>M. Novak </p>
</dd>
<dt><strong>Date</strong></dt><dd><p>July 2023</p>
</dd>
</dl>
</p>
<p>This is a simple version of the G4Box shape to describe geometry objects and use them in the simulation to calculate distance to their boundary from a point inside. Note, that the calculations include a tolerance, e.g. a point is on the surface if closer to a boundary than 1/2 tolerance (kCarTolerance). The two most important methods, used during this simplified simulation, are:</p>
<p><ul class="simple">
<li><p>DistanceToOut(position, direction): distance to boundary from a local position (inside the box) along the given direction. The boundary is ignored if the position is closer to it than 1/2 tolerance (i.e. point is on the surface). The distance to boundary is zero in this case whenever the direction is pointing outisde (i.e. the particle is moving away/out).</p></li>
<li><p>DistanceToOut(postition): this is the <code class="docutils literal notranslate"><span class="pre">safety</span></code>, i.e. the distance to the nearest boundary from the given local point inside (zero if on the surface or outside).</p></li>
</ul>
</p>
<p>This version of the <a class="reference internal" href="#class_box"><span class="std std-ref">Box</span></a> stores an index to the material that fills the shape (therefore closer to the Geant4 <code class="docutils literal notranslate"><span class="pre">logical</span></code> volume concept than to a shape).</p>
<p><a class="reference internal" href="#class_box"><span class="std std-ref">Box</span></a> shapes are constructed for each geometry object in the <code class="docutils literal notranslate"><a class="reference internal" href="#class_geometry"><span class="std std-ref"><span class="pre">Geometry</span></span></a></code> and the above methods are utilised during the simulation step computation in the <code class="docutils literal notranslate"><span class="pre">GammaStepper</span></code> and <code class="docutils literal notranslate"><span class="pre">ElectronStepper</span></code> (in some case indirectly by calling <code class="docutils literal notranslate"><span class="pre">Geometry::DistanceToOut</span></code> that first locates the point, i.e. finds the <a class="reference internal" href="#class_box"><span class="std std-ref">Box</span></a> object which the given global point is located in).</p>
<p>NOTE: a point given in local coordiantes can locate<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">inside</span></code> : if deeper inside than <code class="docutils literal notranslate"><span class="pre">kCarTolerance/2</span></code> from any boundary</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">surface</span></code> : if within <code class="docutils literal notranslate"><span class="pre">kCarTolerance/2</span></code> from any boundary (in- or outside)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">outside</span></code> : if further away than <code class="docutils literal notranslate"><span class="pre">kCarTolerance/2</span></code> from any boundary outside</p></li>
</ul>
</p>
<p>NOTE: distance to volume boundary from a point along a given direction is zero when the point is not <code class="docutils literal notranslate"><span class="pre">inside</span></code> and the direction is pointing away. Therefore, a point located on the surface gives distance to boundary:<ul class="simple">
<li><p>zero : if the direction is pointing outside of that boundary</p></li>
<li><p>non-zero: if the direction is pointing inside of that boundary </p></li>
</ul>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N3Box3BoxERKNSt6stringEiddd">
<span class="target" id="class_box_1a7ac872372c33f5aecf06374c843dceca"></span><span class="sig-name descname"><span class="n"><span class="pre">Box</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">name</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">indxMat</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">pX</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">pY</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">pZ</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N3Box3BoxERKNSt6stringEiddd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Constructor. </p>
<p><dl class="field-list simple">
<dt class="field-odd">param name<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[in]</strong> Name of this volume. </p>
</dd>
<dt class="field-even">param indxMat<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>[in]</strong> Index of the material this volume is filled with. </p>
</dd>
<dt class="field-odd">param pX<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[in]</strong> Half length of the box along the x-axis. </p>
</dd>
<dt class="field-even">param pY<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>[in]</strong> Half length of the box along the y-axis. </p>
</dd>
<dt class="field-odd">param pZ<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[in]</strong> Half length of the box along the z-axis. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N3BoxD0Ev">
<span class="target" id="class_box_1a6a5e09398e85d602a046b429062fb9c2"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">~Box</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N3BoxD0Ev" title="Permalink to this definition"></a><br /></dt>
<dd><p>Destructor (nothig to do) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK3Box7GetNameEv">
<span class="target" id="class_box_1ae360d3e3aa5921e52596d0ff36535913"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">GetName</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK3Box7GetNameEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the name of this volume. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N3Box15SetMaterialIndxEi">
<span class="target" id="class_box_1ab2e8383851eeaa396268241399073081"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SetMaterialIndx</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">indx</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N3Box15SetMaterialIndxEi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set the material this volume is filled with. </p>
<p><dl class="field-list simple">
<dt class="field-odd">param indx<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[in]</strong> Index of the material. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK3Box15GetMaterialIndxEv">
<span class="target" id="class_box_1a0ae7ae21a5e8b6fab545ccb5d67b9763"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GetMaterialIndx</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK3Box15GetMaterialIndxEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the material this volume is filled with. </p>
<p><dl class="field-list simple">
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>Index of the material. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N3Box13SetHalfLengthEdi">
<span class="target" id="class_box_1ab6cccf2b74be881f887f118eb1cdffaf"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SetHalfLength</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">val</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">idx</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N3Box13SetHalfLengthEdi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set the half length of the box along the given axis. </p>
<p><dl class="field-list simple">
<dt class="field-odd">param val<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[in]</strong> Half length in [mm] units. </p>
</dd>
<dt class="field-even">param idx<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>[in]</strong> Encodes the axis along the half length is given (idx=0 –&gt; x; idx=1 –&gt; y; idx=2 –&gt; z). </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK3Box13GetHalfLengthEi">
<span class="target" id="class_box_1a57bcebb25b0e07f573225bbc1bd4b1d1"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GetHalfLength</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">idx</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK3Box13GetHalfLengthEi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the half length of the box along the given axis. </p>
<p><dl class="field-list simple">
<dt class="field-odd">param idx<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[in]</strong> Encodes the axis along the half length is required (idx=0 –&gt; x; idx=1 –&gt; y; idx=2 –&gt; z). </p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>Half length of this box along the required axis. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK3Box13DistanceToOutEPdPd">
<span class="target" id="class_box_1aad17ace7ec8e5b684b09833a3d35a2bc"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DistanceToOut</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">v</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK3Box13DistanceToOutEPdPd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Calculates distance to the volume boundary from inside along the given direction. </p>
<p>Returns the distance along the normalised direction vector <code class="docutils literal notranslate"><span class="pre">v</span></code> to the volume boundary, from the given point <code class="docutils literal notranslate"><span class="pre">p</span></code> inside or on the surface of the box. Intersections with surfaces, when the point is within half tolerance (<code class="docutils literal notranslate"><span class="pre">kCarTolerance/2</span></code>) from a surface, is ignored.</p>
<p><dl class="field-list simple">
<dt class="field-odd">param r<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[in]</strong> 3D position of the point in local coordinates </p>
</dd>
<dt class="field-even">param v<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>[in]</strong> 3D normalised direction </p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>Distance to the surface boundary from inside (see above). </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK3Box13DistanceToOutEPd">
<span class="target" id="class_box_1a29345325f9e40e34dc345b51a48004dd"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DistanceToOut</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">r</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK3Box13DistanceToOutEPd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Calculates the distance to the nearest boundary of a shape from inside (safety). </p>
<p>While the above considers the direction, this finds the nearest boundary.</p>
<p><dl class="field-list simple">
<dt class="field-odd">param r<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[in]</strong> 3D position of the point in local coordinates </p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>Distance to the nearest surface boundary from inside (see above). </p>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-private-members">Private Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3Box5fNameE">
<span class="target" id="class_box_1a2c24355779e7b714cab4581547ea9580"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fName</span></span></span><a class="headerlink" href="#_CPPv4N3Box5fNameE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Name of this volume. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3Box13fMaterialIndxE">
<span class="target" id="class_box_1ae9dbbb9d4a4143cbe2febc01af577f53"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fMaterialIndx</span></span></span><a class="headerlink" href="#_CPPv4N3Box13fMaterialIndxE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Index of the material this volume is filled with. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3Box3fDxE">
<span class="target" id="class_box_1a456992b909ed45dd99e1f1b9f246994c"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fDx</span></span></span><a class="headerlink" href="#_CPPv4N3Box3fDxE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Half length of the box along the x-axis. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3Box3fDyE">
<span class="target" id="class_box_1a341d1fb2d8102035698dfa6a4de4a557"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fDy</span></span></span><a class="headerlink" href="#_CPPv4N3Box3fDyE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Half length of the box along the y-axis. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3Box3fDzE">
<span class="target" id="class_box_1a5e868b153e22d588dd482e45fc69ca7d"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fDz</span></span></span><a class="headerlink" href="#_CPPv4N3Box3fDzE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Half length of the box along the z-axis. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3Box13kCarToleranceE">
<span class="target" id="class_box_1a92e002367dac759cdb49991eccb80869"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">kCarTolerance</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1.0E-9</span></span><a class="headerlink" href="#_CPPv4N3Box13kCarToleranceE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Value of the tolerance in [mm]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3Box6fDeltaE">
<span class="target" id="class_box_1a167d1f1fa5733a0ad9ffed8b492a30c9"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fDelta</span></span></span><a class="headerlink" href="#_CPPv4N3Box6fDeltaE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Half of the above tolerance. </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="the-physics-code-documentation">
<h2>The <code class="docutils literal notranslate"><span class="pre">Physics</span></code> code documentation<a class="headerlink" href="#the-physics-code-documentation" title="Permalink to this heading"></a></h2>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv47Physics">
<span class="target" id="class_physics"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Physics</span></span></span><a class="headerlink" href="#_CPPv47Physics" title="Permalink to this definition"></a><br /></dt>
<dd><p>The entire physics of the simulation is provided by <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> [1] and pulled-in to the <code class="docutils literal notranslate"><span class="pre">HepEmShow</span></code> application by the <code class="docutils literal notranslate"><span class="pre">Physics.hh</span></code> and <code class="docutils literal notranslate"><span class="pre">Physics.cc</span></code> files. </p>
<p><dl class="simple">
<dt><strong>Author</strong></dt><dd><p>M. Novak </p>
</dd>
<dt><strong>Date</strong></dt><dd><p>July 2023</p>
</dd>
</dl>
</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Physics.hh</span></code> header file includes the <code class="docutils literal notranslate"><span class="pre">G4HepEmRun</span></code> headers that give the complete set of run-time functioinalities required for the EM physics modelling. The corresponding implementations are pulled-in all together in the<code class="docutils literal notranslate"><span class="pre">Physics.cc</span></code> implentation file.</p>
<p>The only ingredient of <code class="docutils literal notranslate"><span class="pre">G4HepEmRun</span></code>, that a client application (such as <code class="docutils literal notranslate"><span class="pre">HepEmShow</span></code>), needs to provide is an implementation of a uniform random number generator. An object from such genertor must be plugged-in to the <code class="docutils literal notranslate"><span class="pre">G4HepEmRandomEngine</span></code> by implementing the two missing <code class="docutils literal notranslate"><span class="pre">G4HepEmRandomEngine::flat()</span></code> and <code class="docutils literal notranslate"><span class="pre">G4HepEmRandomEngine::flatArray(const</span> <span class="pre">int,</span> <span class="pre">double</span> <span class="pre">*)</span></code> methods. This is also done in the <code class="docutils literal notranslate"><span class="pre">Physics.cc</span></code> implementation file that completes the implementation of <code class="docutils literal notranslate"><span class="pre">G4HepEmRun</span></code>.</p>
<p><code class="docutils literal notranslate"><a class="reference internal" href="#class_u_random"><span class="std std-ref"><span class="pre">URandom</span></span></a></code> is the uniform random number generator implemented in <code class="docutils literal notranslate"><span class="pre">HepEmShow</span></code> based on the 64-bit verson of the Mersenne Twister generator provided by c++11. An obejct of this is utilised in the <code class="docutils literal notranslate"><span class="pre">Physics.cc</span></code> file to complete the implementation of the <code class="docutils literal notranslate"><span class="pre">G4HepEmRandomEngine</span></code> as mentioned above. Then the actual uniform random number generator and the random engine objects are constructed (and set to the <code class="docutils literal notranslate"><span class="pre">G4HepEmTLData</span></code> obejct) in the <code class="docutils literal notranslate"><span class="pre">HepEmShow.cc</span></code> main function of the application.</p>
<p><code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> implements two top level methods, <code class="docutils literal notranslate"><span class="pre">HowFar</span></code> and <code class="docutils literal notranslate"><span class="pre">Perform</span></code>, in its <code class="docutils literal notranslate"><span class="pre">G4HepEmGammaManager</span></code> and <code class="docutils literal notranslate"><span class="pre">G4HepEmElectronManager</span></code>:<ul class="simple">
<li><p>to provide the information on <code class="docutils literal notranslate"><span class="pre">HowFar</span></code> a given input <span class="math notranslate nohighlight">\(\gamma\)</span> or <span class="math notranslate nohighlight">\(e^-/e^+\)</span> track goes according to their physics related constraints (e.g. till their next physics interaction takes place or other physics related constraints).</p></li>
<li><p>to <code class="docutils literal notranslate"><span class="pre">Perform</span></code> all necessary physics related updates on the given input <span class="math notranslate nohighlight">\(\gamma\)</span> or <span class="math notranslate nohighlight">\(e^-/e^+\)</span> track, including the production of secondary tracks in the given physics interaction (if any).</p></li>
</ul>
</p>
<p>The first (<code class="docutils literal notranslate"><span class="pre">HowFar</span></code>) is invoked at the pre-step point while the second (<code class="docutils literal notranslate"><span class="pre">Perform</span></code>) is at the post-step point of each individual simulation step computation inside the <code class="docutils literal notranslate"><a class="reference internal" href="#class_stepping_loop_1a1d7aa9c14da7b327829dc318d13fc2ed"><span class="std std-ref"><span class="pre">SteppingLoop::GammaStepper()</span></span></a></code> and <code class="docutils literal notranslate"><a class="reference internal" href="#class_stepping_loop_1ad0de81b62ac3ba13532464c2c01f1b39"><span class="std std-ref"><span class="pre">SteppingLoop::ElectronStepper()</span></span></a></code>. </p>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv47URandom">
<span class="target" id="class_u_random"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">URandom</span></span></span><a class="headerlink" href="#_CPPv47URandom" title="Permalink to this definition"></a><br /></dt>
<dd><p>A uniform random number generator. </p>
<p><dl class="simple">
<dt><strong>Author</strong></dt><dd><p>M. Novak </p>
</dd>
<dt><strong>Date</strong></dt><dd><p>July 2023</p>
</dd>
</dl>
</p>
<p>This is the uniform random number generator, i.e. the only thing that is need to make the <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> physics implementation complete (see more at the <code class="docutils literal notranslate"><a class="reference internal" href="#class_physics"><span class="std std-ref"><span class="pre">Physics</span></span></a></code> documentation). This random number generator relies on the c++11 implementation of the 64-bit Mersenne Twister engine. The <code class="docutils literal notranslate"><a class="reference internal" href="#class_u_random_1a869185702aeec4f37a4f788dcd5ea838"><span class="std std-ref"><span class="pre">URandom::flat()</span></span></a></code> method can be used to provide uniform random numbers on the <span class="math notranslate nohighlight">\((0,1)\)</span>. An object from this class is constructed in the <code class="docutils literal notranslate"><span class="pre">HepEmShow</span></code> main and set to be used in the <code class="docutils literal notranslate"><span class="pre">G4HepEmRandomEngine</span></code>.</p>
<p><div class="admonition note">
<p class="admonition-title">Note</p>
<p>This random number generator can be replaced with anything that can provide uniform fandom numbers on <span class="math notranslate nohighlight">\((0,1)\)</span>. One need to modify the corresponding implementations in <code class="docutils literal notranslate"><a class="reference internal" href="#class_physics"><span class="std std-ref"><span class="pre">Physics</span></span></a></code> (namely, one line in the <code class="docutils literal notranslate"><span class="pre">G4HepEmRandomEngine::flat()</span></code> and <code class="docutils literal notranslate"><span class="pre">G4HepEmRandomEngine::flatArray()</span></code> implementations in <code class="docutils literal notranslate"><span class="pre">Physics.cc</span></code>) and replace the <code class="docutils literal notranslate"><a class="reference internal" href="#class_u_random"><span class="std std-ref"><span class="pre">URandom</span></span></a></code> object construction in the <code class="docutils literal notranslate"><span class="pre">HepEmShow</span></code> main. </p>
</div>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7URandom7URandomEi">
<span class="target" id="class_u_random_1a4a68d6fbc770bb3b69b84eb9a1698d94"></span><span class="sig-name descname"><span class="n"><span class="pre">URandom</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">seed</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">123</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7URandom7URandomEi" title="Permalink to this definition"></a><br /></dt>
<dd><p>CTR. </p>
<p><dl class="field-list simple">
<dt class="field-odd">param seed<span class="colon">:</span></dt>
<dd class="field-odd"><p>seed of the random number generator. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7URandomD0Ev">
<span class="target" id="class_u_random_1a31e88fa4b0610950a82d87c535e3d33f"></span><span class="sig-name descname"><span class="n"><span class="pre">~URandom</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7URandomD0Ev" title="Permalink to this definition"></a><br /></dt>
<dd><p>DTR. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7URandom4flatEv">
<span class="target" id="class_u_random_1a869185702aeec4f37a4f788dcd5ea838"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">flat</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7URandom4flatEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Method to provide uniform random numbers on <span class="math notranslate nohighlight">\((0,1)\)</span>. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7URandom7fEngineE">
<span class="target" id="class_u_random_1a091edcd5c38bb2b2a4c0960d4f56c793"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mt19937_64</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fEngine</span></span></span><a class="headerlink" href="#_CPPv4N7URandom7fEngineE" title="Permalink to this definition"></a><br /></dt>
<dd><p>c++11 implementation of the 64-bit Mersenne Twister engine </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7URandom5fDistE">
<span class="target" id="class_u_random_1aa6c951503d67b9be7b2e4fd6de4415b2"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uniform_real_distribution</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">fDist</span></span></span><a class="headerlink" href="#_CPPv4N7URandom5fDistE" title="Permalink to this definition"></a><br /></dt>
<dd><p>uniform distribution: utilises the above random engine to provide random numbers on <span class="math notranslate nohighlight">\((0,1)\)</span></p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="the-primarygenerator-code-documentation">
<h2>The <code class="docutils literal notranslate"><span class="pre">PrimaryGenerator</span></code> code documentation<a class="headerlink" href="#the-primarygenerator-code-documentation" title="Permalink to this heading"></a></h2>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv416PrimaryGenerator">
<span class="target" id="class_primary_generator"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PrimaryGenerator</span></span></span><a class="headerlink" href="#_CPPv416PrimaryGenerator" title="Permalink to this definition"></a><br /></dt>
<dd><p>Generates primary particles for an event. </p>
<p><dl class="simple">
<dt><strong>Author</strong></dt><dd><p>M. Novak </p>
</dd>
<dt><strong>Date</strong></dt><dd><p>July 2023</p>
</dd>
</dl>
</p>
<p>This is a simple primary particle generator. The kinetic energy, position, direction and the particle type (through its charge) can be configured. Note, that we simulate only <span class="math notranslate nohighlight">\(e^-/e^+\)</span> and <span class="math notranslate nohighlight">\(\gamma\)</span> particles with -1, +1 and 0 charge respectively.</p>
<p>The <code class="docutils literal notranslate"><a class="reference internal" href="#class_primary_generator_1a92f67d7b500019b07eea258420c119ed"><span class="std std-ref"><span class="pre">GenerateOne()</span></span></a></code> method is invoked at the beginning of each event. This generates one primary particle/track by setting the properties of the provided <code class="docutils literal notranslate"><span class="pre">G4HepEmTrack</span></code> based on the stored configuration. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N16PrimaryGenerator16PrimaryGeneratorEv">
<span class="target" id="class_primary_generator_1a4de4401188cb2a20b360307550dac97a"></span><span class="sig-name descname"><span class="n"><span class="pre">PrimaryGenerator</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N16PrimaryGenerator16PrimaryGeneratorEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Constructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N16PrimaryGeneratorD0Ev">
<span class="target" id="class_primary_generator_1addbe32e71548024d3efeda6d56fa9179"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">~PrimaryGenerator</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N16PrimaryGeneratorD0Ev" title="Permalink to this definition"></a><br /></dt>
<dd><p>Destructor (nothing to do). </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N16PrimaryGenerator11GenerateOneER12G4HepEmTrack">
<span class="target" id="class_primary_generator_1a92f67d7b500019b07eea258420c119ed"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GenerateOne</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">G4HepEmTrack</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">primTrack</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N16PrimaryGenerator11GenerateOneER12G4HepEmTrack" title="Permalink to this definition"></a><br /></dt>
<dd><p>Generates one primary particle into the provided track. </p>
<p>The <code class="docutils literal notranslate"><a class="reference internal" href="#class_primary_generator_1a92f67d7b500019b07eea258420c119ed"><span class="std std-ref"><span class="pre">GenerateOne()</span></span></a></code> method is invoked at the beginning of each event. This generates one primary particle/track by setting the properties of the provided <code class="docutils literal notranslate"><span class="pre">G4HepEmTrack</span></code> based on the stored configuration.</p>
<p><dl class="field-list simple">
<dt class="field-odd">param primTrack<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[inout]</strong> a track to fill in the primary particle properties </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N16PrimaryGenerator12SetKinEnergyEd">
<span class="target" id="class_primary_generator_1a7973f44f8f33e011625011bc581b86a9"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SetKinEnergy</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ekin</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N16PrimaryGenerator12SetKinEnergyEd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Sets kinetic energy of the primary particle. </p>
<p><dl class="field-list simple">
<dt class="field-odd">param ekin<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[in]</strong> kinetic energy of the primary particle in [MeV] units. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK16PrimaryGenerator12GetKinEnergyEv">
<span class="target" id="class_primary_generator_1ab153cb15576651798f93b3a43b4f5ce2"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GetKinEnergy</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK16PrimaryGenerator12GetKinEnergyEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Privides the kinetic energy of the primary particle. </p>
<p><dl class="field-list simple">
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>kinetic energy in [MeV] units. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N16PrimaryGenerator11SetPositionEPd">
<span class="target" id="class_primary_generator_1ae5cb43ec31588f62873d9372b19d7788"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SetPosition</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pos</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N16PrimaryGenerator11SetPositionEPd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Sets the position of the primary particle. </p>
<p><dl class="field-list simple">
<dt class="field-odd">param pos<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[in]</strong> pointer to a 3D (global) position vector (legth is in [mm]) </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N16PrimaryGenerator11SetPositionEddd">
<span class="target" id="class_primary_generator_1a54b1885f7aa821d23e70952cf8e6e553"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SetPosition</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">y</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">z</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N16PrimaryGenerator11SetPositionEddd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Sets the position of the primary particle. </p>
<p><dl class="field-list simple">
<dt class="field-odd">param x<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[in]</strong> x-coordinate of the positon vector. </p>
</dd>
<dt class="field-even">param y<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>[in]</strong> y-coordinate of the positon vector. </p>
</dd>
<dt class="field-odd">param z<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[in]</strong> z-coordinate of the positon vector. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK16PrimaryGenerator11GetPositionEv">
<span class="target" id="class_primary_generator_1aa7aaba72eed498d9f7246fdc2a4b2bdc"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">GetPosition</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK16PrimaryGenerator11GetPositionEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Provides the 3D position vector of the primary particle. </p>
<p><dl class="field-list simple">
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>pointer to a 3D array that stores the x, y and z-coordinates of the position vector. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N16PrimaryGenerator12SetDirectionEPd">
<span class="target" id="class_primary_generator_1a5821f1896d6ae1e5ac9cb535d812f739"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SetDirection</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dir</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N16PrimaryGenerator12SetDirectionEPd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Sets the direction of the primary particle. </p>
<p><dl class="field-list simple">
<dt class="field-odd">param dir<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[in]</strong> pointer to a 3D normalised direction vector </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N16PrimaryGenerator12SetDirectionEddd">
<span class="target" id="class_primary_generator_1a1c960da9771f4c27722dd31f881381ff"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SetDirection</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">y</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">z</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N16PrimaryGenerator12SetDirectionEddd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Sets the direction of the primary particle. </p>
<p><dl class="field-list simple">
<dt class="field-odd">param x<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[in]</strong> x-coordinate of the normalised direction vector. </p>
</dd>
<dt class="field-even">param y<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>[in]</strong> y-coordinate of the normalised direction vector. </p>
</dd>
<dt class="field-odd">param z<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[in]</strong> z-coordinate of the normalised direction vector. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK16PrimaryGenerator12GetDirectionEv">
<span class="target" id="class_primary_generator_1a8da669cce14bcc039ae99a52fc24ebbf"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">GetDirection</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK16PrimaryGenerator12GetDirectionEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Provides the 3D normalised direction vector of the primary particle. </p>
<p><dl class="field-list simple">
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>pointer to a 3D array that stores the x, y and z-coordinates of the normalised direction. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N16PrimaryGenerator9SetChargeEd">
<span class="target" id="class_primary_generator_1aefe91e38900dce2993b54705f9603564"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SetCharge</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ch</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N16PrimaryGenerator9SetChargeEd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Sets the charge of the primary particle that also determines its type. </p>
<p><dl class="field-list simple">
<dt class="field-odd">param ch<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[in]</strong> the charge in e+ change units: -1 e-; 0 gamma; +1 e+. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK16PrimaryGenerator9GetChargeEv">
<span class="target" id="class_primary_generator_1ac42eead57d8826337acd46257ff16bdc"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GetCharge</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK16PrimaryGenerator9GetChargeEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Privides the charge of the primary particle. </p>
<p><dl class="field-list simple">
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>charge: -1 e-; 0 gamma; +1 e+. </p>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-private-members">Private Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N16PrimaryGenerator10fKinEnergyE">
<span class="target" id="class_primary_generator_1a291044306551ba4b1009787414033a02"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fKinEnergy</span></span></span><a class="headerlink" href="#_CPPv4N16PrimaryGenerator10fKinEnergyE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Kinetic energy of the primary particle in [MeV] units. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N16PrimaryGenerator9fPositionE">
<span class="target" id="class_primary_generator_1ae101eb40f0432f750c20d4263b7b67b6"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fPosition</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">3</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv4N16PrimaryGenerator9fPositionE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Position of the primary particles in (global) coordinates (legth is in [mm]). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N16PrimaryGenerator10fDirectionE">
<span class="target" id="class_primary_generator_1a33b23825762b62ff2cbe8be0368c89fb"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fDirection</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">3</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv4N16PrimaryGenerator10fDirectionE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Normalised direction of the primary particles. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N16PrimaryGenerator7fChargeE">
<span class="target" id="class_primary_generator_1a42705ccba9e6e220beaccc03d965783f"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fCharge</span></span></span><a class="headerlink" href="#_CPPv4N16PrimaryGenerator7fChargeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Charge of the primary particle in units of e+ charge: -1 e-; 0 gamma; +1 e+. </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="auxiliary-code-documentation">
<h2>Auxiliary code documentation<a class="headerlink" href="#auxiliary-code-documentation" title="Permalink to this heading"></a></h2>
<section id="collecting-data-during-the-simulation">
<h3>Collecting data during the simulation<a class="headerlink" href="#collecting-data-during-the-simulation" title="Permalink to this heading"></a></h3>
<p>A collection of data that are recorded during the simulation. </p>
<p><dl class="simple">
<dt><strong>Author</strong></dt><dd><p>M. Novak </p>
</dd>
<dt><strong>Date</strong></dt><dd><p>July 2023</p>
</dd>
</dl>
</p>
<p>The following data is recorded during the simulation (mean is per event):<ul class="simple">
<li><p>mean values in the individual layers of the calorimeter for energy deposit, neutral (gamma) and charged (electron/positron) particle simulation steps</p></li>
<li><p>mean number of energy deposited in the <code class="docutils literal notranslate"><span class="pre">absorber</span></code> and <code class="docutils literal notranslate"><span class="pre">gap</span></code></p></li>
<li><p>mean number of secondary gamma, electron and positrons produced</p></li>
<li><p>mean number of neutral (gamma) and charged (electron/positron)</p></li>
</ul>
</p>
<p>Quantities, recorded in the individual layers are stored in histograms and written to files at the end of the simulation while the others are reported in the screen. An example looks like <div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---</span> <span class="n">Results</span><span class="p">::</span><span class="n">WriteResults</span> <span class="o">----------------------------------</span>

<span class="n">Absorber</span><span class="p">:</span> <span class="n">mean</span> <span class="n">Edep</span> <span class="o">=</span> <span class="mf">6722.95</span> <span class="p">[</span><span class="n">MeV</span><span class="p">]</span> <span class="ow">and</span>  <span class="n">Std</span><span class="o">-</span><span class="n">dev</span> <span class="o">=</span> <span class="mf">309.636</span> <span class="p">[</span><span class="n">MeV</span><span class="p">]</span>
<span class="n">Gap</span>     <span class="p">:</span> <span class="n">mean</span> <span class="n">Edep</span> <span class="o">=</span> <span class="mf">2571.75</span> <span class="p">[</span><span class="n">MeV</span><span class="p">]</span> <span class="ow">and</span>  <span class="n">Std</span><span class="o">-</span><span class="n">dev</span> <span class="o">=</span> <span class="mf">118.507</span> <span class="p">[</span><span class="n">MeV</span><span class="p">]</span>

<span class="n">Mean</span> <span class="n">number</span> <span class="n">of</span> <span class="n">gamma</span>       <span class="mf">4457.043</span>
<span class="n">Mean</span> <span class="n">number</span> <span class="n">of</span> <span class="n">e</span><span class="o">-</span>          <span class="mf">7957.899</span>
<span class="n">Mean</span> <span class="n">number</span> <span class="n">of</span> <span class="n">e</span><span class="o">+</span>          <span class="mf">428.922</span>

<span class="n">Mean</span> <span class="n">number</span> <span class="n">of</span> <span class="n">e</span><span class="o">-/</span><span class="n">e</span><span class="o">+</span> <span class="n">steps</span> <span class="mi">36097</span>
<span class="n">Mean</span> <span class="n">number</span> <span class="n">of</span> <span class="n">gamma</span> <span class="n">steps</span> <span class="mf">40436.2</span>
<span class="o">------------------------------------------------------------</span>
</pre></div>
</div>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv412WriteResultsR7Resultsi">
<span class="target" id="_results_8hh_1a2e94780b3b797ba10abaf1154db56016"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">WriteResults</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv47Results" title="Results"><span class="n"><span class="pre">Results</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">res</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">numEvents</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv412WriteResultsR7Resultsi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Writes the final results of the simulation. </p>
<p>Writes the 3 histrograms (mean energy deposit, <span class="math notranslate nohighlight">\(\gamma\)</span> and <span class="math notranslate nohighlight">\(e^-/e^+\)</span> steps per-layer) into files while all the other collected data to the screen. </p>
</dd></dl>

</div>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv415ResultsPerEvent">
<span class="target" id="struct_results_per_event"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ResultsPerEvent</span></span></span><a class="headerlink" href="#_CPPv415ResultsPerEvent" title="Permalink to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;Results.hh&gt;</em></div>
<p>Data that needs to be accumulated during one <code class="docutils literal notranslate"><span class="pre">event</span></code> (the scope is one event): </p>
<p><ul class="simple">
<li><p>at the beginning of an <code class="docutils literal notranslate"><span class="pre">event</span></code>: usually reset (to zero)</p></li>
<li><p>at the end of an <code class="docutils literal notranslate"><span class="pre">event</span></code>: usually written to the run scope data (see the <code class="docutils literal notranslate"><a class="reference internal" href="#struct_results"><span class="std std-ref"><span class="pre">Results</span></span></a></code> below) </p></li>
</ul>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15ResultsPerEvent8fEdepAbsE">
<span class="target" id="struct_results_per_event_1a56300e62e8aa6cd9fb4b1cbdc6ced71d"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fEdepAbs</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0.0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N15ResultsPerEvent8fEdepAbsE" title="Permalink to this definition"></a><br /></dt>
<dd><p>energy deposit in the absorber during one event </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15ResultsPerEvent8fEdepGapE">
<span class="target" id="struct_results_per_event_1acb585ff9dcb316804b4ac5999ee914d8"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fEdepGap</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0.0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N15ResultsPerEvent8fEdepGapE" title="Permalink to this definition"></a><br /></dt>
<dd><p>energy deposit in the gap during one event </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15ResultsPerEvent12fNumSecGammaE">
<span class="target" id="struct_results_per_event_1a7ec88cb879bc6b6d3457dbe08d1bbf01"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fNumSecGamma</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0.0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N15ResultsPerEvent12fNumSecGammaE" title="Permalink to this definition"></a><br /></dt>
<dd><p>number of seconday <span class="math notranslate nohighlight">\(\gamma\)</span> particles generated during one event </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15ResultsPerEvent15fNumSecElectronE">
<span class="target" id="struct_results_per_event_1a6b4ce615a2259673ce696b747c82812c"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fNumSecElectron</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0.0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N15ResultsPerEvent15fNumSecElectronE" title="Permalink to this definition"></a><br /></dt>
<dd><p>number of seconday <span class="math notranslate nohighlight">\(e^-\)</span> particles generated during one event </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15ResultsPerEvent15fNumSecPositronE">
<span class="target" id="struct_results_per_event_1aaacc361c66159659b16f7016bee3670c"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fNumSecPositron</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0.0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N15ResultsPerEvent15fNumSecPositronE" title="Permalink to this definition"></a><br /></dt>
<dd><p>number of seconday <span class="math notranslate nohighlight">\(e^+\)</span> particles generated during one event </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15ResultsPerEvent14fNumStepsGammaE">
<span class="target" id="struct_results_per_event_1ae02070852cace2b3b94741ef81b200a0"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fNumStepsGamma</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0.0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N15ResultsPerEvent14fNumStepsGammaE" title="Permalink to this definition"></a><br /></dt>
<dd><p>number of <span class="math notranslate nohighlight">\(\gamma\)</span> simulation steps during one event </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15ResultsPerEvent14fNumStepsElPosE">
<span class="target" id="struct_results_per_event_1acf7c36b68976c0d745abf51b964f9335"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fNumStepsElPos</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0.0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N15ResultsPerEvent14fNumStepsElPosE" title="Permalink to this definition"></a><br /></dt>
<dd><p>number of <span class="math notranslate nohighlight">\(e^-/e^+\)</span> simulation steps during one event </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv47Results">
<span class="target" id="struct_results"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Results</span></span></span><a class="headerlink" href="#_CPPv47Results" title="Permalink to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;Results.hh&gt;</em></div>
<p>Data that are collected during the entire <code class="docutils literal notranslate"><span class="pre">run</span></code> of the simulation: </p>
<p><ul class="simple">
<li><p>at the beginning of the <code class="docutils literal notranslate"><span class="pre">ru</span></code>n: need to be initialised</p></li>
<li><p>at the end of an <code class="docutils literal notranslate"><span class="pre">run</span></code>: written out (to file or to the std output) Mean quantities are computed over the simulated events. </p></li>
</ul>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Results13fEdepPerLayerE">
<span class="target" id="struct_results_1a868f71c54a3068363ff43ec93ce835f0"></span><a class="reference internal" href="#_CPPv44Hist" title="Hist"><span class="n"><span class="pre">Hist</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fEdepPerLayer</span></span></span><a class="headerlink" href="#_CPPv4N7Results13fEdepPerLayerE" title="Permalink to this definition"></a><br /></dt>
<dd><p>mean energy deposit per-layer histogram </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Results25fGammaTrackLenghtPerLayerE">
<span class="target" id="struct_results_1af2f609c28fe15e0892646fae98c8ef16"></span><a class="reference internal" href="#_CPPv44Hist" title="Hist"><span class="n"><span class="pre">Hist</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fGammaTrackLenghtPerLayer</span></span></span><a class="headerlink" href="#_CPPv4N7Results25fGammaTrackLenghtPerLayerE" title="Permalink to this definition"></a><br /></dt>
<dd><p>mean number of <span class="math notranslate nohighlight">\(\gamma\)</span> steps per-layer histogram </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Results25fElPosTrackLenghtPerLayerE">
<span class="target" id="struct_results_1a1d825ca3eb96f2604ee4750d6f93bd08"></span><a class="reference internal" href="#_CPPv44Hist" title="Hist"><span class="n"><span class="pre">Hist</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fElPosTrackLenghtPerLayer</span></span></span><a class="headerlink" href="#_CPPv4N7Results25fElPosTrackLenghtPerLayerE" title="Permalink to this definition"></a><br /></dt>
<dd><p>mean number of <span class="math notranslate nohighlight">\(e^-/e^+\)</span> steps per-layer histogram </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Results8fEdepAbsE">
<span class="target" id="struct_results_1a7fc8bebd72ddf91416801fe0a2dbc07b"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fEdepAbs</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0.0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N7Results8fEdepAbsE" title="Permalink to this definition"></a><br /></dt>
<dd><p>mean energy deposit in the <code class="docutils literal notranslate"><span class="pre">absorber</span></code></p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Results9fEdepAbs2E">
<span class="target" id="struct_results_1aa8199cd60249fdbee9e78e2423856dd6"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fEdepAbs2</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0.0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N7Results9fEdepAbs2E" title="Permalink to this definition"></a><br /></dt>
<dd><p>mean of the squared energy deposit in the <code class="docutils literal notranslate"><span class="pre">absorber</span></code></p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Results8fEdepGapE">
<span class="target" id="struct_results_1a6de00d97715d97f9a133f059b7ef6ef0"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fEdepGap</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0.0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N7Results8fEdepGapE" title="Permalink to this definition"></a><br /></dt>
<dd><p>mean energy deposit in the <code class="docutils literal notranslate"><span class="pre">gap</span></code></p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Results9fEdepGap2E">
<span class="target" id="struct_results_1a32993f72fd83dfb4bf5c86b7e9d8ad45"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fEdepGap2</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0.0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N7Results9fEdepGap2E" title="Permalink to this definition"></a><br /></dt>
<dd><p>mean of the squared energy deposit in the <code class="docutils literal notranslate"><span class="pre">gap</span></code></p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Results12fNumSecGammaE">
<span class="target" id="struct_results_1a47beba7267414de3f4f49b24ec415ad0"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fNumSecGamma</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0.0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N7Results12fNumSecGammaE" title="Permalink to this definition"></a><br /></dt>
<dd><p>mean number of the produced secondary <span class="math notranslate nohighlight">\(\gamma\)</span> particles </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Results13fNumSecGamma2E">
<span class="target" id="struct_results_1a3ca7616ea0ea716906d5053182c959c3"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fNumSecGamma2</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0.0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N7Results13fNumSecGamma2E" title="Permalink to this definition"></a><br /></dt>
<dd><p>mean of the squared number of produced secondary <span class="math notranslate nohighlight">\(\gamma\)</span> particles </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Results15fNumSecElectronE">
<span class="target" id="struct_results_1a1e2f826da8897f45b17f9a3ab9debfa3"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fNumSecElectron</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0.0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N7Results15fNumSecElectronE" title="Permalink to this definition"></a><br /></dt>
<dd><p>mean number of the produced secondary <span class="math notranslate nohighlight">\(e^-\)</span> particles </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Results16fNumSecElectron2E">
<span class="target" id="struct_results_1a548c3fab61b24d09d868341d2b2a587c"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fNumSecElectron2</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0.0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N7Results16fNumSecElectron2E" title="Permalink to this definition"></a><br /></dt>
<dd><p>mean of the squared number of produced secondary <span class="math notranslate nohighlight">\(e^-\)</span> particles </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Results15fNumSecPositronE">
<span class="target" id="struct_results_1a9ff96ee9ba078c770be81e807fce7fb3"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fNumSecPositron</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0.0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N7Results15fNumSecPositronE" title="Permalink to this definition"></a><br /></dt>
<dd><p>mean number of the produced secondary <span class="math notranslate nohighlight">\(e^+\)</span> particles </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Results16fNumSecPositron2E">
<span class="target" id="struct_results_1a54033a6b6e44c31928bf3f47002c2dbf"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fNumSecPositron2</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0.0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N7Results16fNumSecPositron2E" title="Permalink to this definition"></a><br /></dt>
<dd><p>mean of the squared number of produced secondary <span class="math notranslate nohighlight">\(e^+\)</span> particles </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Results14fNumStepsGammaE">
<span class="target" id="struct_results_1a40a1269864fb39cb90b41eb20543b812"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fNumStepsGamma</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0.0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N7Results14fNumStepsGammaE" title="Permalink to this definition"></a><br /></dt>
<dd><p>mean number of <span class="math notranslate nohighlight">\(\gamma\)</span> steps in the entire calorimeter </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Results15fNumStepsGamma2E">
<span class="target" id="struct_results_1aa7e6a1539475aaf2c03219ae4e592948"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fNumStepsGamma2</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0.0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N7Results15fNumStepsGamma2E" title="Permalink to this definition"></a><br /></dt>
<dd><p>mean of the squared number of <span class="math notranslate nohighlight">\(\gamma\)</span> steps in the entire calorimeter </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Results14fNumStepsElPosE">
<span class="target" id="struct_results_1a155d60e512b400067017049605b6bf92"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fNumStepsElPos</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0.0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N7Results14fNumStepsElPosE" title="Permalink to this definition"></a><br /></dt>
<dd><p>mean number of <span class="math notranslate nohighlight">\(e^-/e^+\)</span> steps in the entire calorimeter </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Results15fNumStepsElPos2E">
<span class="target" id="struct_results_1a931fd090154f4d3298a74fe488034456"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fNumStepsElPos2</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="m"><span class="pre">0.0</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N7Results15fNumStepsElPos2E" title="Permalink to this definition"></a><br /></dt>
<dd><p>mean of the squared number of <span class="math notranslate nohighlight">\(e^-/e^+\)</span> steps in the entire calorimeter </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Results12fPerEventResE">
<span class="target" id="struct_results_1ab17af8cb8b09a2c55f3b2d7d4c8f07a9"></span><a class="reference internal" href="#_CPPv415ResultsPerEvent" title="ResultsPerEvent"><span class="n"><span class="pre">ResultsPerEvent</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fPerEventRes</span></span></span><a class="headerlink" href="#_CPPv4N7Results12fPerEventResE" title="Permalink to this definition"></a><br /></dt>
<dd><p>data structure to accumulate results during a single event </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv44Hist">
<span class="target" id="class_hist"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Hist</span></span></span><a class="headerlink" href="#_CPPv44Hist" title="Permalink to this definition"></a><br /></dt>
<dd><p>A simple histogram only to collect some data during the simulation. </p>
<p><dl class="simple">
<dt><strong>Author</strong></dt><dd><p>M. Novak </p>
</dd>
<dt><strong>Date</strong></dt><dd><p>July 2023 </p>
</dd>
</dl>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4Hist4HistERKNSt6stringEddi">
<span class="target" id="class_hist_1a126aa63a703e1143ead88cbb18432759"></span><span class="sig-name descname"><span class="n"><span class="pre">Hist</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">filename</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">min</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">max</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">numbin</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4Hist4HistERKNSt6stringEddi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Constructor. </p>
<p><dl class="field-list simple">
<dt class="field-odd">param filename<span class="colon">:</span></dt>
<dd class="field-odd"><p>String to be used as file name when writing into file. </p>
</dd>
<dt class="field-even">param min<span class="colon">:</span></dt>
<dd class="field-even"><p>Minimum bin value. </p>
</dd>
<dt class="field-odd">param max<span class="colon">:</span></dt>
<dd class="field-odd"><p>Maximum bin value. </p>
</dd>
<dt class="field-even">param numbin<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of bins required between <code class="docutils literal notranslate"><span class="pre">min</span></code> and <code class="docutils literal notranslate"><span class="pre">max</span></code>. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4Hist4HistERKNSt6stringEddd">
<span class="target" id="class_hist_1a5aeb6c2d0e4967d732427cfde67f2dce"></span><span class="sig-name descname"><span class="n"><span class="pre">Hist</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">filename</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">min</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">max</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">delta</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4Hist4HistERKNSt6stringEddd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Constructor. </p>
<p><dl class="field-list simple">
<dt class="field-odd">param filename<span class="colon">:</span></dt>
<dd class="field-odd"><p>String to be used as file name when writing into file. </p>
</dd>
<dt class="field-even">param min<span class="colon">:</span></dt>
<dd class="field-even"><p>Minimum bin value. </p>
</dd>
<dt class="field-odd">param max<span class="colon">:</span></dt>
<dd class="field-odd"><p>Maximum bin value. </p>
</dd>
<dt class="field-even">param delta<span class="colon">:</span></dt>
<dd class="field-even"><p>Required width of a bin. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4Hist4HistEv">
<span class="target" id="class_hist_1a1d872656e56cbe3d44fa69ca110bc68a"></span><span class="sig-name descname"><span class="n"><span class="pre">Hist</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4Hist4HistEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Default constructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4HistD0Ev">
<span class="target" id="class_hist_1a33efa5f5905fa72c4ea41d416c7d5456"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">~Hist</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4HistD0Ev" title="Permalink to this definition"></a><br /></dt>
<dd><p>Destructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4Hist10InitializeEv">
<span class="target" id="class_hist_1a79f2da3286205ec4cb025cddfd307f8a"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Initialize</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4Hist10InitializeEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Auxiliary method to setup the initial state of the histogram. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4Hist5ReSetERKNSt6stringEddi">
<span class="target" id="class_hist_1ac6959a1bab2f319671b4e44398ebce2a"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ReSet</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">filename</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">min</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">max</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">numbins</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4Hist5ReSetERKNSt6stringEddi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Method to modify the properties of the histogram. </p>
<p><dl class="field-list simple">
<dt class="field-odd">param filename<span class="colon">:</span></dt>
<dd class="field-odd"><p>The new name of the filename. </p>
</dd>
<dt class="field-even">param min<span class="colon">:</span></dt>
<dd class="field-even"><p>The new minimum bin value. </p>
</dd>
<dt class="field-odd">param max<span class="colon">:</span></dt>
<dd class="field-odd"><p>The new maximum bin value. </p>
</dd>
<dt class="field-even">param numbins<span class="colon">:</span></dt>
<dd class="field-even"><p>The new number of bins required between <code class="docutils literal notranslate"><span class="pre">min</span></code> and <code class="docutils literal notranslate"><span class="pre">max</span></code>. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4Hist4FillEd">
<span class="target" id="class_hist_1a83904f1855afc769d8cfa1be636f8172"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Fill</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4Hist4FillEd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Method to populate the histogram with data: the corresponding bin content is increased by 1. </p>
<p><dl class="field-list simple">
<dt class="field-odd">param x<span class="colon">:</span></dt>
<dd class="field-odd"><p>Value to add. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4Hist4FillEdd">
<span class="target" id="class_hist_1a1ff2822e4272fae23a83b7f22d507a8c"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Fill</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">w</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4Hist4FillEdd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Method to populate the histogram with data and a weight: the corresponding bin content is increased by the weight. </p>
<p><dl class="field-list simple">
<dt class="field-odd">param x<span class="colon">:</span></dt>
<dd class="field-odd"><p>Value to add. </p>
</dd>
<dt class="field-even">param w<span class="colon">:</span></dt>
<dd class="field-even"><p>The corresponding weight. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4Hist5ScaleEd">
<span class="target" id="class_hist_1ac6196bc73e90d6d3fa21701520f7be5a"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Scale</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">sc</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4Hist5ScaleEd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Method to scale all bin content by a constant. </p>
<p><dl class="field-list simple">
<dt class="field-odd">param sc<span class="colon">:</span></dt>
<dd class="field-odd"><p>Scaling factor. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4Hist10GetNumBinsEv">
<span class="target" id="class_hist_1a0195888d2c9f0fb12cd5eb713795b399"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GetNumBins</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4Hist10GetNumBinsEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Method to provide the number of bins. </p>
<p><dl class="field-list simple">
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>Number of bins. </p>
</dd>
</dl>
</p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="providing-input-arguments-to-the-hepemshow-application">
<h3>Providing input arguments to the <code class="docutils literal notranslate"><span class="pre">HepEmShow</span></code> application<a class="headerlink" href="#providing-input-arguments-to-the-hepemshow-application" title="Permalink to this heading"></a></h3>
<p>To see all configuration option, run the application as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">HepEmShow</span> <span class="o">--</span><span class="n">help</span>

<span class="o">===</span> <span class="n">Usage</span><span class="p">:</span> <span class="n">HepEmShow</span> <span class="p">[</span><span class="n">OPTIONS</span><span class="p">]</span>

    <span class="o">-</span><span class="n">l</span>  <span class="o">--</span><span class="n">number</span><span class="o">-</span><span class="n">of</span><span class="o">-</span><span class="n">layers</span>      <span class="p">(</span><span class="n">number</span> <span class="n">of</span> <span class="n">layers</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">calorimeter</span><span class="p">)</span>           <span class="o">-</span> <span class="n">default</span><span class="p">:</span> <span class="mi">50</span>
    <span class="o">-</span><span class="n">a</span>  <span class="o">--</span><span class="n">absorber</span><span class="o">-</span><span class="n">thickness</span>    <span class="p">(</span><span class="ow">in</span> <span class="p">[</span><span class="n">mm</span><span class="p">]</span> <span class="n">units</span><span class="p">)</span>                                 <span class="o">-</span> <span class="n">default</span><span class="p">:</span> <span class="mf">2.3</span>
    <span class="o">-</span><span class="n">g</span>  <span class="o">--</span><span class="n">gap</span><span class="o">-</span><span class="n">thickness</span>         <span class="p">(</span><span class="ow">in</span> <span class="p">[</span><span class="n">mm</span><span class="p">]</span> <span class="n">units</span><span class="p">)</span>                                 <span class="o">-</span> <span class="n">default</span><span class="p">:</span> <span class="mf">5.7</span>
    <span class="o">-</span><span class="n">t</span>  <span class="o">--</span><span class="n">transverse</span><span class="o">-</span><span class="n">size</span>       <span class="p">(</span><span class="n">of</span> <span class="n">the</span> <span class="n">calorimeter</span> <span class="ow">in</span> <span class="p">[</span><span class="n">mm</span><span class="p">]</span> <span class="n">units</span><span class="p">)</span>              <span class="o">-</span> <span class="n">default</span><span class="p">:</span> <span class="mi">400</span>
    <span class="o">-</span><span class="n">p</span>  <span class="o">--</span><span class="n">primary</span><span class="o">-</span><span class="n">particle</span>      <span class="p">(</span><span class="n">possible</span> <span class="n">particle</span> <span class="n">names</span><span class="p">:</span> <span class="n">e</span><span class="o">-</span><span class="p">,</span> <span class="n">e</span><span class="o">+</span> <span class="ow">and</span> <span class="n">gamma</span><span class="p">)</span>     <span class="o">-</span> <span class="n">default</span><span class="p">:</span> <span class="n">e</span><span class="o">-</span>
    <span class="o">-</span><span class="n">e</span>  <span class="o">--</span><span class="n">primary</span><span class="o">-</span><span class="n">energy</span>        <span class="p">(</span><span class="ow">in</span> <span class="p">[</span><span class="n">MeV</span><span class="p">]</span> <span class="n">units</span><span class="p">)</span>                                <span class="o">-</span> <span class="n">default</span><span class="p">:</span> <span class="mi">10</span> <span class="mi">000</span>
    <span class="o">-</span><span class="n">n</span>  <span class="o">--</span><span class="n">number</span><span class="o">-</span><span class="n">of</span><span class="o">-</span><span class="n">events</span>      <span class="p">(</span><span class="n">number</span> <span class="n">of</span> <span class="n">primary</span> <span class="n">events</span> <span class="n">to</span> <span class="n">simulate</span><span class="p">)</span>          <span class="o">-</span> <span class="n">default</span><span class="p">:</span> <span class="mi">1000</span>
    <span class="o">-</span><span class="n">s</span>  <span class="o">--</span><span class="n">random</span><span class="o">-</span><span class="n">seed</span>                                                           <span class="o">-</span> <span class="n">default</span><span class="p">:</span> <span class="mi">1234</span>
    <span class="o">-</span><span class="n">d</span>  <span class="o">--</span><span class="n">g4hepem</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="n">file</span>     <span class="p">(</span><span class="n">the</span> <span class="n">pre</span><span class="o">-</span><span class="n">generated</span> <span class="n">data</span> <span class="n">file</span> <span class="k">with</span> <span class="n">its</span> <span class="n">path</span><span class="p">)</span>     <span class="o">-</span> <span class="n">default</span><span class="p">:</span> <span class="o">../</span><span class="n">data</span><span class="o">/</span><span class="n">hepem_data</span>
    <span class="o">-</span><span class="n">v</span>  <span class="o">--</span><span class="n">run</span><span class="o">-</span><span class="n">verbosity</span>         <span class="p">(</span><span class="n">verbosity</span> <span class="n">of</span> <span class="n">run</span> <span class="n">infomation</span><span class="p">:</span> <span class="n">nothing</span> <span class="n">when</span> <span class="mi">0</span><span class="p">)</span>   <span class="o">-</span> <span class="n">default</span><span class="p">:</span> <span class="mi">1</span>
    <span class="o">-</span><span class="n">h</span>  <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv415InputParameters">
<span class="target" id="struct_input_parameters"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InputParameters</span></span></span><a class="headerlink" href="#_CPPv415InputParameters" title="Permalink to this definition"></a><br /></dt>
<dd><p>A data structure that encapsulates all the possible input arguments of the <code class="docutils literal notranslate"><span class="pre">HepEmShow</span></code> application. </p>
<p><dl class="simple">
<dt><strong>Author</strong></dt><dd><p>M. Novak </p>
</dd>
<dt><strong>Date</strong></dt><dd><p>Aug 2023 </p>
</dd>
</dl>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N15InputParameters15InputParametersEv">
<span class="target" id="struct_input_parameters_1a2ede6d73636729561755f9ca986475f8"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InputParameters</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N15InputParameters15InputParametersEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>CTR with default values: default geometry, primary and event configuirations (see below) with pre-generated data files expected at <code class="docutils literal notranslate"><span class="pre">../data/hepem_data</span></code> relative to the <code class="docutils literal notranslate"><span class="pre">HepEmShow</span></code> executable. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15InputParameters9fGeometryE">
<span class="target" id="struct_input_parameters_1a921dbfbac71b688dfde11060591e69ed"></span><a class="reference internal" href="#_CPPv4N15InputParameters8GeometryE" title="InputParameters::Geometry"><span class="n"><span class="pre">Geometry</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fGeometry</span></span></span><a class="headerlink" href="#_CPPv4N15InputParameters9fGeometryE" title="Permalink to this definition"></a><br /></dt>
<dd><p>the geometry related configuration </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15InputParameters17fPrimaryAndEventsE">
<span class="target" id="struct_input_parameters_1a34ce91465085f18f7e76bdb5a1f2a1b3"></span><a class="reference internal" href="#_CPPv4N15InputParameters16PrimaryAndEventsE" title="InputParameters::PrimaryAndEvents"><span class="n"><span class="pre">PrimaryAndEvents</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fPrimaryAndEvents</span></span></span><a class="headerlink" href="#_CPPv4N15InputParameters17fPrimaryAndEventsE" title="Permalink to this definition"></a><br /></dt>
<dd><p>the primary partcile and events related configuration </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15InputParameters16fG4HepEmDataFileE">
<span class="target" id="struct_input_parameters_1a3a00664f729cff9c2ede9a82be35f9f1"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fG4HepEmDataFile</span></span></span><a class="headerlink" href="#_CPPv4N15InputParameters16fG4HepEmDataFileE" title="Permalink to this definition"></a><br /></dt>
<dd><p>the pre-generated data file (with path) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15InputParameters13fRunVerbosityE">
<span class="target" id="struct_input_parameters_1ae5022264c5b3d91446c18fd975a6f742"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fRunVerbosity</span></span></span><a class="headerlink" href="#_CPPv4N15InputParameters13fRunVerbosityE" title="Permalink to this definition"></a><br /></dt>
<dd><p>level of printout verbosity duing setting up: nothing when &lt; 1. </p>
</dd></dl>

</div>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N15InputParameters8GeometryE">
<span class="target" id="struct_input_parameters_1_1_geometry"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Geometry</span></span></span><a class="headerlink" href="#_CPPv4N15InputParameters8GeometryE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The geometry related input arguments. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N15InputParameters8Geometry8GeometryEv">
<span class="target" id="struct_input_parameters_1_1_geometry_1a8ff86e44e708b2f283144e44f546e025"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Geometry</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N15InputParameters8Geometry8GeometryEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>CTR with default values: 50 layers of 2.3 mm absorber and 5.7 mm gap with 400 mm transvers size. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15InputParameters8Geometry10fNumLayersE">
<span class="target" id="struct_input_parameters_1_1_geometry_1a1da1662e45b6034aa1e3e04f97bc2d03"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fNumLayers</span></span></span><a class="headerlink" href="#_CPPv4N15InputParameters8Geometry10fNumLayersE" title="Permalink to this definition"></a><br /></dt>
<dd><p>number of layers in the calorimeter </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15InputParameters8Geometry18fThicknessAbsorberE">
<span class="target" id="struct_input_parameters_1_1_geometry_1aaec005d9ef9029fe121d6323eb9faf76"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fThicknessAbsorber</span></span></span><a class="headerlink" href="#_CPPv4N15InputParameters8Geometry18fThicknessAbsorberE" title="Permalink to this definition"></a><br /></dt>
<dd><p>absorber thickness along X in [mm] </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15InputParameters8Geometry13fThicknessGapE">
<span class="target" id="struct_input_parameters_1_1_geometry_1a7d1ac576d4ec41f45b470fe468d097a9"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fThicknessGap</span></span></span><a class="headerlink" href="#_CPPv4N15InputParameters8Geometry13fThicknessGapE" title="Permalink to this definition"></a><br /></dt>
<dd><p>gap thickness along X in [mm] </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15InputParameters8Geometry14fThicknessCaloE">
<span class="target" id="struct_input_parameters_1_1_geometry_1a50bbe4e295d36cb85cd32312863c88f1"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fThicknessCalo</span></span></span><a class="headerlink" href="#_CPPv4N15InputParameters8Geometry14fThicknessCaloE" title="Permalink to this definition"></a><br /></dt>
<dd><p>calorimeter thickness along X [mm] ONLY if number of layers is zero </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15InputParameters8Geometry15fSizeTransverseE">
<span class="target" id="struct_input_parameters_1_1_geometry_1afc52a39c40d78b6939cc676088fa42d4"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fSizeTransverse</span></span></span><a class="headerlink" href="#_CPPv4N15InputParameters8Geometry15fSizeTransverseE" title="Permalink to this definition"></a><br /></dt>
<dd><p>calorimeter full size along YZ in [mm] </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N15InputParameters16PrimaryAndEventsE">
<span class="target" id="struct_input_parameters_1_1_primary_and_events"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PrimaryAndEvents</span></span></span><a class="headerlink" href="#_CPPv4N15InputParameters16PrimaryAndEventsE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The primary partcile and events related input arguments. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N15InputParameters16PrimaryAndEvents16PrimaryAndEventsEv">
<span class="target" id="struct_input_parameters_1_1_primary_and_events_1a266b39bff4d4717797753c9bce2d6ba1"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PrimaryAndEvents</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N15InputParameters16PrimaryAndEvents16PrimaryAndEventsEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>CTR with default values: simulate 1000 events, starting with an electron of 10 GeV each (do not report progress). </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15InputParameters16PrimaryAndEvents13fParticleNameE">
<span class="target" id="struct_input_parameters_1_1_primary_and_events_1abe7bda9ce7c54ed3d23dbf9dced99fb4"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fParticleName</span></span></span><a class="headerlink" href="#_CPPv4N15InputParameters16PrimaryAndEvents13fParticleNameE" title="Permalink to this definition"></a><br /></dt>
<dd><p>primary particle name: {“e-”, “e+” or “gamma”} </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15InputParameters16PrimaryAndEvents15fParticleEnergyE">
<span class="target" id="struct_input_parameters_1_1_primary_and_events_1a9f8bb9a2b488ca127faf32c26ebbf019"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fParticleEnergy</span></span></span><a class="headerlink" href="#_CPPv4N15InputParameters16PrimaryAndEvents15fParticleEnergyE" title="Permalink to this definition"></a><br /></dt>
<dd><p>primary particle energy in [MeV] </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15InputParameters16PrimaryAndEvents10fNumEventsE">
<span class="target" id="struct_input_parameters_1_1_primary_and_events_1a55e5297ef8e8203d4942afff69a61ba8"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fNumEvents</span></span></span><a class="headerlink" href="#_CPPv4N15InputParameters16PrimaryAndEvents10fNumEventsE" title="Permalink to this definition"></a><br /></dt>
<dd><p>number of events to simulate (each will start with a single primary) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15InputParameters16PrimaryAndEvents11fRandomSeedE">
<span class="target" id="struct_input_parameters_1_1_primary_and_events_1a9e856f4c65b7c54b585712a80e7e27d2"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fRandomSeed</span></span></span><a class="headerlink" href="#_CPPv4N15InputParameters16PrimaryAndEvents11fRandomSeedE" title="Permalink to this definition"></a><br /></dt>
<dd><p>seed for the random number generator </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</section>
<section id="event-loop-stepping-loops-and-the-track-stack">
<h3>Event loop, stepping loops and the track stack<a class="headerlink" href="#event-loop-stepping-loops-and-the-track-stack" title="Permalink to this heading"></a></h3>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv49EventLoop">
<span class="target" id="class_event_loop"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">EventLoop</span></span></span><a class="headerlink" href="#_CPPv49EventLoop" title="Permalink to this definition"></a><br /></dt>
<dd><p>Event loop for simulating the required number of primary tracks/events. </p>
<p><dl class="simple">
<dt><strong>Author</strong></dt><dd><p>M. Novak </p>
</dd>
<dt><strong>Date</strong></dt><dd><p>July 2023</p>
</dd>
</dl>
</p>
<p>The <code class="docutils literal notranslate"><a class="reference internal" href="#class_event_loop_1a7b1d4b512c5fa676bd990cfaa6d561c9"><span class="std std-ref"><span class="pre">EventLoop::ProcessEvents()</span></span></a></code> method is responsible to generate track(s) for the required number of events and simulate the histories of all primary and their secondary tracks. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-static-functions">Public Static Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N9EventLoop13ProcessEventsER13G4HepEmTLDataR12G4HepEmStateR16PrimaryGeneratorR8GeometryR7Resultsii">
<span class="target" id="class_event_loop_1a7b1d4b512c5fa676bd990cfaa6d561c9"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ProcessEvents</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">G4HepEmTLData</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theTLData</span></span>, <span class="n"><span class="pre">G4HepEmState</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theState</span></span>, <a class="reference internal" href="#_CPPv416PrimaryGenerator" title="PrimaryGenerator"><span class="n"><span class="pre">PrimaryGenerator</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">thePrimaryGenerator</span></span>, <a class="reference internal" href="#_CPPv48Geometry" title="Geometry"><span class="n"><span class="pre">Geometry</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theGeometry</span></span>, <a class="reference internal" href="#_CPPv47Results" title="Results"><span class="n"><span class="pre">Results</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theResult</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">numEventToSimulate</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">verbosity</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N9EventLoop13ProcessEventsER13G4HepEmTLDataR12G4HepEmStateR16PrimaryGeneratorR8GeometryR7Resultsii" title="Permalink to this definition"></a><br /></dt>
<dd><p>Generates and simulates the required number of events. </p>
<p>Events, i.e. primary track(s) are generated by using the input <code class="docutils literal notranslate"><a class="reference internal" href="#class_primary_generator"><span class="std std-ref"><span class="pre">PrimaryGenerator</span></span></a></code>. At the beginning of each event, the <code class="docutils literal notranslate"><a class="reference internal" href="#class_primary_generator"><span class="std std-ref"><span class="pre">PrimaryGenerator</span></span></a></code> is used to generate the primary track(s) that belong to the actual event. Note, that we have only one primary track per-event at the moment. The generated primary track(s) is inserted/pushed into the <code class="docutils literal notranslate"><a class="reference internal" href="#class_track_stack"><span class="std std-ref"><span class="pre">TrackStack</span></span></a></code> as the very first track and the simulation of the event starts. During the simulation of the event:<ul class="simple">
<li><p>one track is popped from the stack and the appropriate <code class="docutils literal notranslate"><a class="reference internal" href="#class_stepping_loop"><span class="std std-ref"><span class="pre">SteppingLoop</span></span></a></code> is called to simulate its entire history ina step-by-step way</p></li>
<li><p>at the end of each simulation step, secondary tracks that are created in that step in the related physics interaction (if any), are inserted/pushed into the <code class="docutils literal notranslate"><a class="reference internal" href="#class_track_stack"><span class="std std-ref"><span class="pre">TrackStack</span></span></a></code> Simulation of the event is completed when the <code class="docutils literal notranslate"><a class="reference internal" href="#class_track_stack"><span class="std std-ref"><span class="pre">TrackStack</span></span></a></code> becomes empty. See the implementation for more details.</p></li>
</ul>
</p>
<p>In order to be able to collect some infomation during the event processing, the <code class="docutils literal notranslate"><a class="reference internal" href="#class_event_loop_1af34a47f54be63c327216ab77bb0505d4"><span class="std std-ref"><span class="pre">BeginOfEventAction()</span></span></a></code>/<code class="docutils literal notranslate"><a class="reference internal" href="#class_event_loop_1ac63175ca75f98869d887e0b4dd72e38e"><span class="std std-ref"><span class="pre">EndOfEventAction()</span></span></a></code> methods are invoked before/after each event processing while the <code class="docutils literal notranslate"><a class="reference internal" href="#class_event_loop_1a4fd22ea39b677d0802d70f67e571b616"><span class="std std-ref"><span class="pre">BeginOfTrackingAction()</span></span></a></code>/<code class="docutils literal notranslate"><a class="reference internal" href="#class_event_loop_1ad4213d30cae150022509656095dd8f88"><span class="std std-ref"><span class="pre">EndOfTrackingAction()</span></span></a></code> methods are invoked before/after tracking each new track.</p>
<p><dl class="field-list simple">
<dt class="field-odd">param theTLData<span class="colon">:</span></dt>
<dd class="field-odd"><p>a <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> specific (thread local) object primarily used to obtain all physics related information from <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> needed to compute a simulation step </p>
</dd>
<dt class="field-even">param theState<span class="colon">:</span></dt>
<dd class="field-even"><p>a <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> specific object that stores pointers to the top level <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> data structure and parameters that are used by <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> to provide all physics related infomation needed to compute a simulation step </p>
</dd>
<dt class="field-odd">param thePrimaryGenerator<span class="colon">:</span></dt>
<dd class="field-odd"><p>the primary generator that is used to generate primary track(s) at the beginning of each event (only one primary track per event in our case now) </p>
</dd>
<dt class="field-even">param theGeometry<span class="colon">:</span></dt>
<dd class="field-even"><p>the geometry of the application in which the input track history is simulated </p>
</dd>
<dt class="field-odd">param theResult<span class="colon">:</span></dt>
<dd class="field-odd"><p>the data structure that holds all the infomation needs to be collected during the simulation. </p>
</dd>
<dt class="field-even">param numEventToSimulate<span class="colon">:</span></dt>
<dd class="field-even"><p>number of events required to be simulated </p>
</dd>
<dt class="field-odd">param verbosity<span class="colon">:</span></dt>
<dd class="field-odd"><p>to control the verbosity of printouts reporting progress and state of the event processing </p>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-private-static-functions">Private Static Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N9EventLoop18BeginOfEventActionER7ResultsiRK12G4HepEmTrack">
<span class="target" id="class_event_loop_1af34a47f54be63c327216ab77bb0505d4"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BeginOfEventAction</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv47Results" title="Results"><span class="n"><span class="pre">Results</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theResult</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">eventID</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">G4HepEmTrack</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">thePrimaryTrack</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N9EventLoop18BeginOfEventActionER7ResultsiRK12G4HepEmTrack" title="Permalink to this definition"></a><br /></dt>
<dd><p>Method invoked at the beginning of each event by passing the (single) primary track of the event. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N9EventLoop16EndOfEventActionER7Resultsi">
<span class="target" id="class_event_loop_1ac63175ca75f98869d887e0b4dd72e38e"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">EndOfEventAction</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv47Results" title="Results"><span class="n"><span class="pre">Results</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theResult</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">eventID</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N9EventLoop16EndOfEventActionER7Resultsi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Method invoked at the end of each event. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N9EventLoop21BeginOfTrackingActionER7ResultsR12G4HepEmTrack">
<span class="target" id="class_event_loop_1a4fd22ea39b677d0802d70f67e571b616"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BeginOfTrackingAction</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv47Results" title="Results"><span class="n"><span class="pre">Results</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theResult</span></span>, <span class="n"><span class="pre">G4HepEmTrack</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theTrack</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N9EventLoop21BeginOfTrackingActionER7ResultsR12G4HepEmTrack" title="Permalink to this definition"></a><br /></dt>
<dd><p>Method invoked before start tracking of a new track (provided as input argument). </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N9EventLoop19EndOfTrackingActionER7ResultsR12G4HepEmTrack">
<span class="target" id="class_event_loop_1ad4213d30cae150022509656095dd8f88"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">EndOfTrackingAction</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv47Results" title="Results"><span class="n"><span class="pre">Results</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theResult</span></span>, <span class="n"><span class="pre">G4HepEmTrack</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theTrack</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N9EventLoop19EndOfTrackingActionER7ResultsR12G4HepEmTrack" title="Permalink to this definition"></a><br /></dt>
<dd><p>Method invoked after terminating tracking of a track (provided as input argument). </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv412SteppingLoop">
<span class="target" id="class_stepping_loop"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SteppingLoop</span></span></span><a class="headerlink" href="#_CPPv412SteppingLoop" title="Permalink to this definition"></a><br /></dt>
<dd><p>Stepping loops for simulating <span class="math notranslate nohighlight">\(e^-\)</span>, <span class="math notranslate nohighlight">\(e^+\)</span> and <span class="math notranslate nohighlight">\(\gamma\)</span> particle histories. </p>
<p><dl class="simple">
<dt><strong>Author</strong></dt><dd><p>M. Novak </p>
</dd>
<dt><strong>Date</strong></dt><dd><p>July 2023</p>
</dd>
</dl>
</p>
<p>The stepping loops can calculate a given <span class="math notranslate nohighlight">\(\gamma\)</span> or <span class="math notranslate nohighlight">\(e^-/e^+\)</span> particle simulation history from their initial state till the end in a step-by-step way (by the <code class="docutils literal notranslate"><a class="reference internal" href="#class_stepping_loop_1a1d7aa9c14da7b327829dc318d13fc2ed"><span class="std std-ref"><span class="pre">SteppingLoop::GammaStepper</span></span></a><span class="pre">(G4HepEmTLData&amp;,</span> <span class="pre">G4HepEmState&amp;,</span> <a class="reference internal" href="#class_track_stack"><span class="std std-ref"><span class="pre">TrackStack</span></span></a><span class="pre">&amp;,</span> <a class="reference internal" href="#class_geometry"><span class="std std-ref"><span class="pre">Geometry</span></span></a><span class="pre">&amp;,</span> <a class="reference internal" href="#struct_results"><span class="std std-ref"><span class="pre">Results</span></span></a><span class="pre">&amp;,</span> <span class="pre">int)</span></code> and <code class="docutils literal notranslate"><a class="reference internal" href="#class_stepping_loop_1ad0de81b62ac3ba13532464c2c01f1b39"><span class="std std-ref"><span class="pre">SteppingLoop::ElectronStepper</span></span></a><span class="pre">(G4HepEmTLData&amp;,</span> <span class="pre">G4HepEmState&amp;,</span> <a class="reference internal" href="#class_track_stack"><span class="std std-ref"><span class="pre">TrackStack</span></span></a><span class="pre">&amp;,</span> <a class="reference internal" href="#class_geometry"><span class="std std-ref"><span class="pre">Geometry</span></span></a><span class="pre">&amp;,</span> <a class="reference internal" href="#struct_results"><span class="std std-ref"><span class="pre">Results</span></span></a><span class="pre">&amp;,</span> <span class="pre">int)</span></code> respectively). At each step:<ul class="simple">
<li><p>the actual step length is calculated (accounting both the geometrical and the physics related constraints)</p></li>
<li><p>the track is moved to its post-step position</p></li>
<li><p>all physics related actions, happening along and/or at the post-step point, are performed on the track</p></li>
<li><p>secondary tracks, generated in the given step by a physics interaction (if any), are insterted into the track stack (by calling the <code class="docutils literal notranslate"><a class="reference internal" href="#class_stepping_loop_1af0fc2b1e935c4f75824521c1976e5644"><span class="std std-ref"><span class="pre">SteppingLoop::StackSecondaries</span></span></a><span class="pre">(G4HepEmTLData&amp;,</span> <a class="reference internal" href="#class_track_stack"><span class="std std-ref"><span class="pre">TrackStack</span></span></a><span class="pre">&amp;,</span> <span class="pre">G4HepEmTrack&amp;)</span></code> method)</p></li>
<li><p>information (e.g. energy deposit) might be collected at the end of each simulation step (by calling the <code class="docutils literal notranslate"><a class="reference internal" href="#class_stepping_loop_1a473d26c5090a12b239c3e2a1ac682243"><span class="std std-ref"><span class="pre">SteppingLoop::SteppingAction</span></span></a><span class="pre">(</span><a class="reference internal" href="#struct_results"><span class="std std-ref"><span class="pre">Results</span></span></a><span class="pre">&amp;,</span> <span class="pre">const</span> <span class="pre">G4HepEmTrack&amp;,</span> <span class="pre">const</span> <span class="pre">Box*,</span> <span class="pre">double,</span> <span class="pre">int,</span> <span class="pre">int,</span> <span class="pre">int,</span> <span class="pre">int)</span></code> method )</p></li>
</ul>
</p>
<p><strong>A bit more details</strong>:</p>
<p>A simulation history is terminated when:<ul class="simple">
<li><p>the particle kinetic energy becomes zero (e.g. an <span class="math notranslate nohighlight">\(e^-\)</span> lost all its kinetic energy along its last step)</p></li>
<li><p>the particle participated in a destructive interaction (e.g. photoelectric absorption of a <span class="math notranslate nohighlight">\(\gamma\)</span> photon or conversion to <span class="math notranslate nohighlight">\(e^-/e^+\)</span> pairs)</p></li>
<li><p>the particle leaves the calorimeter (in a normal <code class="docutils literal notranslate"><span class="pre">Geant4</span></code> simulation the the history is terminated when the particle leaves the world)</p></li>
</ul>
</p>
<p>The physics related step length constraints as well as the actions (including the secondary track production) are provided by the <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> implementation of the EM physics simulation.</p>
<p><code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> implements two top level methods, in its Gamma and Electron managers:<ul class="simple">
<li><p>to provide the information on <code class="docutils literal notranslate"><span class="pre">HowFar</span></code> a given input <span class="math notranslate nohighlight">\(\gamma\)</span> or <span class="math notranslate nohighlight">\(e^-/e^+\)</span> track goes according to their physics related constraints (e.g. till their next physics interaction takes place or due to other physics related constraints).</p></li>
<li><p>to <code class="docutils literal notranslate"><span class="pre">Perform</span></code> all necessary physics related updates on the given input <span class="math notranslate nohighlight">\(\gamma\)</span> or <span class="math notranslate nohighlight">\(e^-/e^+\)</span> track and produce all secondary tracks in the given physics interaction (if any).</p></li>
</ul>
</p>
<p>The first (<code class="docutils literal notranslate"><span class="pre">HowFar</span></code>) is invoked at the pre-step point while the second (<code class="docutils literal notranslate"><span class="pre">Perform</span></code>) is at the post-step point of each individual simulation step computation inside the <code class="docutils literal notranslate"><a class="reference internal" href="#class_stepping_loop_1a1d7aa9c14da7b327829dc318d13fc2ed"><span class="std std-ref"><span class="pre">SteppingLoop::GammaStepper()</span></span></a></code> and <code class="docutils literal notranslate"><a class="reference internal" href="#class_stepping_loop_1ad0de81b62ac3ba13532464c2c01f1b39"><span class="std std-ref"><span class="pre">SteppingLoop::ElectronStepper()</span></span></a></code>.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> it’s the <code class="docutils literal notranslate"><span class="pre">G4HepEmTLData</span></code> (thread local data) that is used in the top level, two sided communication between the consumer and <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code>. It encapsulates the (primary and secondary) tracks and the random number generator dedicated for one particular thread. Its <strong>primary</strong> Gamma/Electron track field is used to store the actual state of the <span class="math notranslate nohighlight">\(\gamma\)</span> or <span class="math notranslate nohighlight">\(e^-/e^+\)</span> track that is under tracking. The step limit, imposed by all physics related constraints on the actual track, is calculated at each pre-step point by calling the bove-mentioned <code class="docutils literal notranslate"><span class="pre">HowFar</span></code> top level method provided by <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code>. Then the <code class="docutils literal notranslate"><span class="pre">Perform</span></code> method needs to be invoked at the post-step point that performs all necessary physics related updates on the input <strong>primary</strong> track while produces all <strong>scondary</strong> tracks related to the given physics interaction (if any). The secondary tracks are delivered back to the caller in the appropriate <strong>seondary</strong> track fields of the <code class="docutils literal notranslate"><span class="pre">G4HepEmTLData</span></code> object.</p>
<p>We might provide more details on how a <span class="math notranslate nohighlight">\(\gamma\)</span> and <span class="math notranslate nohighlight">\(e^-/e^+\)</span> simulation step is computed but you might find some information by inspecting the implementations of the top level <code class="docutils literal notranslate"><span class="pre">HowFar</span></code> and <code class="docutils literal notranslate"><span class="pre">Perform</span></code> <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> methods in the corresponding <code class="docutils literal notranslate"><span class="pre">G4HepEmGammaManager/G4HepEmElectronManager</span></code>. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-static-functions">Public Static Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N12SteppingLoop12GammaStepperER13G4HepEmTLDataR12G4HepEmStateR10TrackStackR8GeometryR7Resultsi">
<span class="target" id="class_stepping_loop_1a1d7aa9c14da7b327829dc318d13fc2ed"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GammaStepper</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">G4HepEmTLData</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theTLData</span></span>, <span class="n"><span class="pre">G4HepEmState</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theState</span></span>, <a class="reference internal" href="#_CPPv410TrackStack" title="TrackStack"><span class="n"><span class="pre">TrackStack</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theTrackStack</span></span>, <a class="reference internal" href="#_CPPv48Geometry" title="Geometry"><span class="n"><span class="pre">Geometry</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theGeometry</span></span>, <a class="reference internal" href="#_CPPv47Results" title="Results"><span class="n"><span class="pre">Results</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theResult</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">eventID</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N12SteppingLoop12GammaStepperER13G4HepEmTLDataR12G4HepEmStateR10TrackStackR8GeometryR7Resultsi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Stepping loop for simulating the entire history of a <span class="math notranslate nohighlight">\(\gamma\)</span> track. </p>
<p>The initial state of the <span class="math notranslate nohighlight">\(\gamma\)</span> track is provided in the <code class="docutils literal notranslate"><span class="pre">G4HepEmGammaTrack</span></code> field of <code class="docutils literal notranslate"><span class="pre">theTLData</span></code> input argument by the caller. The history is simulated then till the end, the state of the <span class="math notranslate nohighlight">\(\gamma\)</span> track is updated while secondary tracks, produced in the physics interactions, are pushed to <code class="docutils literal notranslate"><span class="pre">theTrackStack</span></code> (if any) and the required simulation results are collected/updated into <code class="docutils literal notranslate"><span class="pre">theResult</span></code> structure after each individual simulation step.</p>
<p><dl class="field-list simple">
<dt class="field-odd">param theTLData<span class="colon">:</span></dt>
<dd class="field-odd"><p>a <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> specific (thread local) object primarily used to obtain all physics related information from <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> needed to compute a simulation step </p>
</dd>
<dt class="field-even">param theState<span class="colon">:</span></dt>
<dd class="field-even"><p>a <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> specific object that stores pointers to the top level <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> data structure and parameters that are used by <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> to provide all physics related infomation needed to compute a simulation step </p>
</dd>
<dt class="field-odd">param theTrackStack<span class="colon">:</span></dt>
<dd class="field-odd"><p>the track stack that is used to store the secondary tracks produced while simulating the entire history o fthe input <span class="math notranslate nohighlight">\(\gamma\)</span> track </p>
</dd>
<dt class="field-even">param theGeometry<span class="colon">:</span></dt>
<dd class="field-even"><p>the geometry of the application in which the input track history is simulated </p>
</dd>
<dt class="field-odd">param theResult<span class="colon">:</span></dt>
<dd class="field-odd"><p>the data structure that holds all the infomation needs to be collected during the simulation. It might be updated after each simulation step by calling the <code class="docutils literal notranslate"><span class="pre">SteppingAction</span></code> method. </p>
</dd>
<dt class="field-even">param eventID<span class="colon">:</span></dt>
<dd class="field-even"><p>ID of the currently simulated event, i.e. the one to which the given input <span class="math notranslate nohighlight">\(\gamma\)</span> track belongs to </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N12SteppingLoop15ElectronStepperER13G4HepEmTLDataR12G4HepEmStateR10TrackStackR8GeometryR7Resultsi">
<span class="target" id="class_stepping_loop_1ad0de81b62ac3ba13532464c2c01f1b39"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ElectronStepper</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">G4HepEmTLData</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theTLData</span></span>, <span class="n"><span class="pre">G4HepEmState</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theState</span></span>, <a class="reference internal" href="#_CPPv410TrackStack" title="TrackStack"><span class="n"><span class="pre">TrackStack</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theTrackStack</span></span>, <a class="reference internal" href="#_CPPv48Geometry" title="Geometry"><span class="n"><span class="pre">Geometry</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theGeometry</span></span>, <a class="reference internal" href="#_CPPv47Results" title="Results"><span class="n"><span class="pre">Results</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theResult</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">eventID</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N12SteppingLoop15ElectronStepperER13G4HepEmTLDataR12G4HepEmStateR10TrackStackR8GeometryR7Resultsi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Stepping loop for simulating the entire history of a <span class="math notranslate nohighlight">\(e^-/e^+\)</span> track. </p>
<p>The initial state of the <span class="math notranslate nohighlight">\(e^-/e^+\)</span> track is provided in the <code class="docutils literal notranslate"><span class="pre">G4HepEmGammaTrack</span></code> field of <code class="docutils literal notranslate"><span class="pre">theTLData</span></code> input argument by the caller. The history is simulated then till the end, the state of the <span class="math notranslate nohighlight">\(e^-/e^+\)</span> track is updated while secondary tracks, produced in the physics interactions, are pushed to <code class="docutils literal notranslate"><span class="pre">theTrackStack</span></code> (if any) and the required simulation results are collected/updated into <code class="docutils literal notranslate"><span class="pre">theResult</span></code> structure after each individual simulation step.</p>
<p><dl class="field-list simple">
<dt class="field-odd">param theTLData<span class="colon">:</span></dt>
<dd class="field-odd"><p>a <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> specific (thread local) object primarily used to obtain all physics related information from <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> needed to compute a simulation step </p>
</dd>
<dt class="field-even">param theState<span class="colon">:</span></dt>
<dd class="field-even"><p>a <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> specific object that stores pointers to the top level <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> data structure and parameters that are used by <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> to provide all physics related infomation needed to compute a simulation step </p>
</dd>
<dt class="field-odd">param theTrackStack<span class="colon">:</span></dt>
<dd class="field-odd"><p>the track stack that is used to store the secondary tracks produced while simulating the entire history o fthe input <span class="math notranslate nohighlight">\(e^-/e^+\)</span> track </p>
</dd>
<dt class="field-even">param theGeometry<span class="colon">:</span></dt>
<dd class="field-even"><p>the geometry of the application in which the input track history is simulated </p>
</dd>
<dt class="field-odd">param theResult<span class="colon">:</span></dt>
<dd class="field-odd"><p>the data structure that holds all the infomation needs to be collected during the simulation. It might be updated after each simulation step by calling the <code class="docutils literal notranslate"><span class="pre">SteppingAction</span></code> method. </p>
</dd>
<dt class="field-even">param eventID<span class="colon">:</span></dt>
<dd class="field-even"><p>ID of the currently simulated event, i.e. the one to which the given input <span class="math notranslate nohighlight">\(e^-/e^+\)</span> track belongs to </p>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-private-static-functions">Private Static Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N12SteppingLoop16StackSecondariesER13G4HepEmTLDataR10TrackStackR12G4HepEmTrack">
<span class="target" id="class_stepping_loop_1af0fc2b1e935c4f75824521c1976e5644"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">StackSecondaries</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">G4HepEmTLData</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theTLData</span></span>, <a class="reference internal" href="#_CPPv410TrackStack" title="TrackStack"><span class="n"><span class="pre">TrackStack</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theTrackStack</span></span>, <span class="n"><span class="pre">G4HepEmTrack</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">thePrimary</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N12SteppingLoop16StackSecondariesER13G4HepEmTLDataR10TrackStackR12G4HepEmTrack" title="Permalink to this definition"></a><br /></dt>
<dd><p>Auxiliary method that pushes the secondary track(s), produced by physics interactions at the post-step point (if any), into the track stack. </p>
<p><dl class="field-list simple">
<dt class="field-odd">param theTLData<span class="colon">:</span></dt>
<dd class="field-odd"><p>the <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> specific (thread local) object that is used by <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> to deliver the secondary tracks to the caller after calling the its <code class="docutils literal notranslate"><span class="pre">Perform</span></code> top level method </p>
</dd>
<dt class="field-even">param theTrackStack<span class="colon">:</span></dt>
<dd class="field-even"><p>the track stack that is used to store the secondary tracks produced while simulating the entire history of the input track in the steppers </p>
</dd>
<dt class="field-odd">param thePrimary<span class="colon">:</span></dt>
<dd class="field-odd"><p>the primary track, in its post interaction state (after calling <code class="docutils literal notranslate"><span class="pre">G4HepEm</span></code> top level <code class="docutils literal notranslate"><span class="pre">Perform</span></code> method), i.e. the one that underwent the physics interaction </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N12SteppingLoop14SteppingActionER7ResultsRK12G4HepEmTrackPK3Boxdiiii">
<span class="target" id="class_stepping_loop_1a473d26c5090a12b239c3e2a1ac682243"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SteppingAction</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv47Results" title="Results"><span class="n"><span class="pre">Results</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theResult</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">G4HepEmTrack</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">theTrack</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv43Box" title="Box"><span class="n"><span class="pre">Box</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">currentVolume</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">currentPhysStepLength</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">indxLayer</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">indxAbsorber</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">eventID</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stepID</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N12SteppingLoop14SteppingActionER7ResultsRK12G4HepEmTrackPK3Boxdiiii" title="Permalink to this definition"></a><br /></dt>
<dd><p>This method is called at the end of each simulation steps to collect some data during the simulation. </p>
<p>This method provides the possibility of collecting some data after each simulation steps (e.g. energy deposit or length of the step). Among the <code class="docutils literal notranslate"><span class="pre">Geant4</span></code> user actions this corresponds to the <code class="docutils literal notranslate"><span class="pre">G4UserSteppingAction</span></code></p>
<p><dl class="field-list simple">
<dt class="field-odd">param theResult<span class="colon">:</span></dt>
<dd class="field-odd"><p>the data structure that holds all the infomation needs to be collected during the simulation (some fields might be updated) </p>
</dd>
<dt class="field-even">param theTrack<span class="colon">:</span></dt>
<dd class="field-even"><p>the primary track, in its post interaction state, i.e. at the end of the step </p>
</dd>
<dt class="field-odd">param currentVolume<span class="colon">:</span></dt>
<dd class="field-odd"><p>pointer to the volume (<code class="docutils literal notranslate"><span class="pre">absorber</span></code>/<code class="docutils literal notranslate"><span class="pre">gap</span></code>) in which the simulation step was done </p>
</dd>
<dt class="field-even">param currentPhysStepLength<span class="colon">:</span></dt>
<dd class="field-even"><p>real (physical) length of the step </p>
</dd>
<dt class="field-odd">param indxLayer<span class="colon">:</span></dt>
<dd class="field-odd"><p>index of the layer in which the step was done </p>
</dd>
<dt class="field-even">param indxAbsorber<span class="colon">:</span></dt>
<dd class="field-even"><p>indicates if the step was done in the <code class="docutils literal notranslate"><span class="pre">absorber</span></code> (0) or in the <code class="docutils literal notranslate"><span class="pre">gap</span></code> (1) </p>
</dd>
<dt class="field-odd">param eventID<span class="colon">:</span></dt>
<dd class="field-odd"><p>ID of the event to which the particle under tracking belongs to </p>
</dd>
<dt class="field-even">param stepID<span class="colon">:</span></dt>
<dd class="field-even"><p>ID of this step that was just performed, i.e. number of steps cmpleted so far with with the current track </p>
</dd>
</dl>
</p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv410TrackStack">
<span class="target" id="class_track_stack"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TrackStack</span></span></span><a class="headerlink" href="#_CPPv410TrackStack" title="Permalink to this definition"></a><br /></dt>
<dd><p>A simple track-stack to handle both primary and secondary particle tracks. </p>
<p><dl class="simple">
<dt><strong>Author</strong></dt><dd><p>M. Novak </p>
</dd>
<dt><strong>Date</strong></dt><dd><p>July 2023</p>
</dd>
</dl>
</p>
<p>This stack holds tracks (all belonging to the same event), that are still to be tracking (i.e. still need to call/instert to the appropriate <code class="docutils literal notranslate"><a class="reference internal" href="#class_stepping_loop"><span class="std std-ref"><span class="pre">SteppingLoop</span></span></a></code>):<ul class="simple">
<li><p>at the begining of each event, (a) primary track is inserted into the stack (inside the <code class="docutils literal notranslate"><a class="reference internal" href="#class_event_loop_1a7b1d4b512c5fa676bd990cfaa6d561c9"><span class="std std-ref"><span class="pre">EventLoop::ProcessEvents()</span></span></a></code>) as the very first track (NOTE: assumed to have only one primary per event for simplicity)</p></li>
<li><p>all secondaries, generated by the entire simulation of the event, are inserted when created (inside the appropriate <code class="docutils literal notranslate"><a class="reference internal" href="#class_stepping_loop"><span class="std std-ref"><span class="pre">SteppingLoop</span></span></a></code>), i.e. pushed and later popped for tracking</p></li>
<li><p>the event is completed when the track-stack becomes empty again</p></li>
</ul>
</p>
<p>A new event can be started then. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10TrackStack10TrackStackEv">
<span class="target" id="class_track_stack_1a6d118a8cc1aa0f0c83797e764747cedf"></span><span class="sig-name descname"><span class="n"><span class="pre">TrackStack</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10TrackStack10TrackStackEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>CTR. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10TrackStackD0Ev">
<span class="target" id="class_track_stack_1a9762dba449e945f1391e4272b495b4e6"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">~TrackStack</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10TrackStackD0Ev" title="Permalink to this definition"></a><br /></dt>
<dd><p>DTR. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10TrackStack7PopIntoER12G4HepEmTrack">
<span class="target" id="class_track_stack_1a528b5fd33f46021e878d4d82dbbedd74"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PopInto</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">G4HepEmTrack</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">track</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10TrackStack7PopIntoER12G4HepEmTrack" title="Permalink to this definition"></a><br /></dt>
<dd><p>Pops a secondary track from the stack and writes to the input address. </p>
<p>This method is called from <code class="docutils literal notranslate"><a class="reference internal" href="#class_event_loop_1a7b1d4b512c5fa676bd990cfaa6d561c9"><span class="std std-ref"><span class="pre">EventLoop::ProcessEvents()</span></span></a></code> before start tracking a new track. It returns with the original index of the popped track or -1 when the track is actually empty, i.e. no more track to pop.</p>
<p><dl class="field-list simple">
<dt class="field-odd">param track<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>[inout]</strong> the address of the <code class="docutils literal notranslate"><span class="pre">G4HepEmTrack</span></code> where the next track should be popped, i.e. copied. </p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>returns with the original index of the popped track or -1 if the there are no more tracks in the track </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10TrackStack18GetTypeOfNextTrackEv">
<span class="target" id="class_track_stack_1a71cd14abad3d3d0693658e5d4a1315eb"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GetTypeOfNextTrack</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10TrackStack18GetTypeOfNextTrackEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Can provide the type of the next track. </p>
<p>Returns with an integer that encodes the type of the next track in the stack, i.e. the type of the track that will be popped when calling <code class="docutils literal notranslate"><a class="reference internal" href="#class_track_stack_1a528b5fd33f46021e878d4d82dbbedd74"><span class="std std-ref"><span class="pre">PopInto()</span></span></a></code> next time.</p>
<p><dl class="field-list simple">
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>an integer indicating the type of the next track:<ul class="simple">
<li><p>-1 in case of <span class="math notranslate nohighlight">\(e^-\)</span></p></li>
<li><p>0 in case of <span class="math notranslate nohighlight">\(\gamma\)</span></p></li>
<li><p>+1 in case of <span class="math notranslate nohighlight">\(e^+\)</span></p></li>
<li><p>-999 if the stack is empty </p></li>
</ul>
</p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10TrackStack6InsertEv">
<span class="target" id="class_track_stack_1a0f33c1b9f159ba9d6e0953c67cf1e4e2"></span><span class="n"><span class="pre">G4HepEmTrack</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">Insert</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10TrackStack6InsertEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Returns a reference to a secondary track that can be used to push a new track into the stack. </p>
<p>This method is called whenever a new track needs to be inseted into the stack. The provided reference can be used to fill the track infomation (the referenced track is re-set).</p>
<p><dl class="field-list simple">
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>A reference to a <code class="docutils literal notranslate"><span class="pre">G4HepEmTrack</span></code> that can be used to add a new track to the stack (by filling in its filed). </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10TrackStack4CopyER12G4HepEmTrackR12G4HepEmTrack">
<span class="target" id="class_track_stack_1ae87bf7ff4f6836e10cf3b7e277b0d653"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Copy</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">G4HepEmTrack</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">from</span></span>, <span class="n"><span class="pre">G4HepEmTrack</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">to</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10TrackStack4CopyER12G4HepEmTrackR12G4HepEmTrack" title="Permalink to this definition"></a><br /></dt>
<dd><p>Copying the content of the <code class="docutils literal notranslate"><span class="pre">from</span></code> to the <code class="docutils literal notranslate"><span class="pre">to</span></code> track. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10TrackStack14GetNextTrackIDEv">
<span class="target" id="class_track_stack_1a4e4f64496afddaacd19dcf99c1008402"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GetNextTrackID</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10TrackStack14GetNextTrackIDEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Returns with the next track ID (track ID is incremented whenever this method is invoked). </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10TrackStack12ReSetTrackIDEv">
<span class="target" id="class_track_stack_1a1fd724f7c0c8b125304786c6f4b0e00c"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ReSetTrackID</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10TrackStack12ReSetTrackIDEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Resets the track ID to zero. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-private-members">Private Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N10TrackStack5fSizeE">
<span class="target" id="class_track_stack_1a7c3631cc17083505d626d0ff669c16cf"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fSize</span></span></span><a class="headerlink" href="#_CPPv4N10TrackStack5fSizeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>current capacity of the track stack </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N10TrackStack8fCurIndxE">
<span class="target" id="class_track_stack_1a3917da2d4c2a007a69e1ba9e02af032d"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fCurIndx</span></span></span><a class="headerlink" href="#_CPPv4N10TrackStack8fCurIndxE" title="Permalink to this definition"></a><br /></dt>
<dd><p>number of tracks used from the capacity </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N10TrackStack15fCurrentTrackIDE">
<span class="target" id="class_track_stack_1a5c45f50a86755ec9e93fb524d2684f89"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fCurrentTrackID</span></span></span><a class="headerlink" href="#_CPPv4N10TrackStack15fCurrentTrackIDE" title="Permalink to this definition"></a><br /></dt>
<dd><p>current track ID </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N10TrackStack10fTrackVectE">
<span class="target" id="class_track_stack_1a3d2e0b43b1ded801b0c98300ac8766d1"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">G4HepEmTrack</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fTrackVect</span></span></span><a class="headerlink" href="#_CPPv4N10TrackStack10fTrackVectE" title="Permalink to this definition"></a><br /></dt>
<dd><p>the stack as a vector of tracks </p>
</dd></dl>

</div>
</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../CodeDoc.html" class="btn btn-neutral float-left" title="Code documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../zzbib.html" class="btn btn-neutral float-right" title="Bibliography" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, M.Novak.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>